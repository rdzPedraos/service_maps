import{t as C,l as c}from"./leaflet.a3cf53d3.js";function p(){return p=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},p.apply(this,arguments)}function N(e,r){e.prototype=Object.create(r.prototype),e.prototype.constructor=e,y(e,r)}function y(e,r){return y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},y(e,r)}function x(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function L(e,r,t){return L=x()?Reflect.construct.bind():function(n,o,i){var s=[null];s.push.apply(s,o);var a=new(Function.bind.apply(n,s));return i&&y(a,i.prototype),a},L.apply(null,arguments)}function u(e,r,t,n){r===void 0&&(r=""),n===void 0&&(n={});var o=document.createElement(e);return r&&(o.className=r),Object.keys(n).forEach(function(i){if(typeof n[i]=="function"){var s=i.indexOf("on")===0?i.substr(2).toLowerCase():i;o.addEventListener(s,n[i])}else i==="html"?o.innerHTML=n[i]:i==="text"?o.innerText=n[i]:o.setAttribute(i,n[i])}),t&&t.appendChild(o),o}function m(e){e.preventDefault(),e.stopPropagation()}var v=function(){return[].slice.call(arguments).filter(Boolean).join(" ").trim()};function f(e,r){e&&e.classList&&(Array.isArray(r)?r:[r]).forEach(function(t){e.classList.contains(t)||e.classList.add(t)})}function l(e,r){e&&e.classList&&(Array.isArray(r)?r:[r]).forEach(function(t){e.classList.contains(t)&&e.classList.remove(t)})}var b,g=13,k=40,R=38,F=[g,27,k,R,37,39],I=function(){function e(t){var n=this,o=t.handleSubmit,i=t.searchLabel,s=t.classNames,a=s===void 0?{}:s;this.container=void 0,this.form=void 0,this.input=void 0,this.handleSubmit=void 0,this.hasError=!1,this.container=u("div",v("geosearch",a.container)),this.form=u("form",["",a.form].join(" "),this.container,{autocomplete:"none",onClick:m,onDblClick:m,touchStart:m,touchEnd:m}),this.input=u("input",["glass",a.input].join(" "),this.form,{type:"text",placeholder:i||"search",onInput:this.onInput,onKeyUp:function(h){return n.onKeyUp(h)},onKeyPress:function(h){return n.onKeyPress(h)},onFocus:this.onFocus,onBlur:this.onBlur,onClick:function(){n.input.focus(),n.input.dispatchEvent(new Event("focus"))}}),this.handleSubmit=o}var r=e.prototype;return r.onFocus=function(){f(this.form,"active")},r.onBlur=function(){l(this.form,"active")},r.onSubmit=function(t){try{var n=this;return m(t),l(o=n.container,"error"),f(o,"pending"),Promise.resolve(n.handleSubmit({query:n.input.value})).then(function(){l(n.container,"pending")})}catch(i){return Promise.reject(i)}var o},r.onInput=function(){this.hasError&&(l(this.container,"error"),this.hasError=!1)},r.onKeyUp=function(t){t.keyCode===27&&(l(this.container,["pending","active"]),this.input.value="",document.body.focus(),document.body.blur())},r.onKeyPress=function(t){t.keyCode===g&&this.onSubmit(t)},r.setQuery=function(t){this.input.value=t},e}(),A=function(){function e(t){var n=this,o=t.handleClick,i=t.classNames,s=i===void 0?{}:i,a=t.notFoundMessage;this.handleClick=void 0,this.selected=-1,this.results=[],this.container=void 0,this.resultItem=void 0,this.notFoundMessage=void 0,this.onClick=function(h){if(typeof n.handleClick=="function"){var d=h.target;if(d&&n.container.contains(d)&&d.hasAttribute("data-key")){var w=Number(d.getAttribute("data-key"));n.handleClick({result:n.results[w]})}}},this.handleClick=o,this.notFoundMessage=a?u("div",v(s.notfound),void 0,{html:a}):void 0,this.container=u("div",v("results",s.resultlist)),this.container.addEventListener("click",this.onClick,!0),this.resultItem=u("div",v(s.item))}var r=e.prototype;return r.render=function(t,n){var o=this;t===void 0&&(t=[]),this.clear(),t.forEach(function(i,s){var a=o.resultItem.cloneNode(!0);a.setAttribute("data-key",""+s),a.innerHTML=n({result:i}),o.container.appendChild(a)}),t.length>0?(f(this.container.parentElement,"open"),f(this.container,"active")):this.notFoundMessage&&(this.container.appendChild(this.notFoundMessage),f(this.container.parentElement,"open")),this.results=t},r.select=function(t){return Array.from(this.container.children).forEach(function(n,o){return o===t?f(n,"active"):l(n,"active")}),this.selected=t,this.results[t]},r.count=function(){return this.results?this.results.length:0},r.clear=function(){for(this.selected=-1;this.container.lastChild;)this.container.removeChild(this.container.lastChild);l(this.container.parentElement,"open"),l(this.container,"active")},e}(),E={position:"topleft",style:"button",showMarker:!0,showPopup:!1,popupFormat:function(e){return""+e.result.label},resultFormat:function(e){return""+e.result.label},marker:{icon:C&&c.Icon?new c.Icon.Default:void 0,draggable:!1},maxMarkers:1,maxSuggestions:5,retainZoomLevel:!1,animateZoom:!0,searchLabel:"Enter address",clearSearchLabel:"Clear search",notFoundMessage:"",messageHideDelay:3e3,zoomLevel:18,classNames:{container:"leaflet-bar leaflet-control leaflet-control-geosearch",button:"leaflet-bar-part leaflet-bar-part-single",resetButton:"reset",msgbox:"leaflet-bar message",form:"",input:"",resultlist:"",item:"",notfound:"leaflet-bar-notfound"},autoComplete:!0,autoCompleteDelay:250,autoClose:!1,keepResult:!1,updateMap:!0},P="Leaflet must be loaded before instantiating the GeoSearch control",M={options:p({},E),classNames:p({},E.classNames),initialize:function(e){var r,t,n,o,i=this;if(!C)throw new Error(P);if(!e.provider)throw new Error("Provider is missing from options");this.options=p({},E,e),this.classNames=p({},this.classNames,e.classNames),this.markers=new c.FeatureGroup,this.classNames.container+=" leaflet-geosearch-"+this.options.style,this.searchElement=new I({searchLabel:this.options.searchLabel,classNames:{container:this.classNames.container,form:this.classNames.form,input:this.classNames.input},handleSubmit:function(s){return i.onSubmit(s)}}),this.button=u("a",this.classNames.button,this.searchElement.container,{title:this.options.searchLabel,href:"#",onClick:function(s){return i.onClick(s)}}),c.DomEvent.disableClickPropagation(this.button),this.resetButton=u("button",this.classNames.resetButton,this.searchElement.form,{text:"\xD7","aria-label":this.options.clearSearchLabel,onClick:function(){i.searchElement.input.value===""?i.close():i.clearResults(null,!0)}}),c.DomEvent.disableClickPropagation(this.resetButton),this.options.autoComplete&&(this.resultList=new A({handleClick:function(s){var a=s.result;i.searchElement.input.value=a.label,i.onSubmit({query:a.label,data:a})},classNames:{resultlist:this.classNames.resultlist,item:this.classNames.item,notfound:this.classNames.notfound},notFoundMessage:this.options.notFoundMessage}),this.searchElement.form.appendChild(this.resultList.container),this.searchElement.input.addEventListener("keyup",(r=function(s){return i.autoSearch(s)},(t=this.options.autoCompleteDelay)===void 0&&(t=250),n===void 0&&(n=!1),function(){var s=[].slice.call(arguments);o&&clearTimeout(o),o=setTimeout(function(){o=null,n||r.apply(void 0,s)},t),n&&!o&&r.apply(void 0,s)}),!0),this.searchElement.input.addEventListener("keydown",function(s){return i.selectResult(s)},!0),this.searchElement.input.addEventListener("keydown",function(s){return i.clearResults(s,!0)},!0)),this.searchElement.form.addEventListener("click",function(s){s.preventDefault()},!1)},onAdd:function(e){var r=this.options,t=r.showMarker,n=r.style;if(this.map=e,t&&this.markers.addTo(e),n==="bar"){var o=e.getContainer().querySelector(".leaflet-control-container");this.container=u("div","leaflet-control-geosearch leaflet-geosearch-bar"),this.container.appendChild(this.searchElement.form),o.appendChild(this.container)}return c.DomEvent.disableClickPropagation(this.searchElement.form),this.searchElement.container},onRemove:function(){var e;return(e=this.container)==null||e.remove(),this},open:function(){var e=this.searchElement,r=e.input;f(e.container,"active"),r.focus()},close:function(){l(this.searchElement.container,"active"),this.clearResults()},onClick:function(e){e.preventDefault(),e.stopPropagation(),this.searchElement.container.classList.contains("active")?this.close():this.open()},selectResult:function(e){if([g,k,R].indexOf(e.keyCode)!==-1)if(e.preventDefault(),e.keyCode!==g){var r=this.resultList.count()-1;if(!(r<0)){var t=this.resultList.selected,n=e.keyCode===k?t+1:t-1,o=this.resultList.select(n<0?r:n>r?0:n);this.searchElement.input.value=o.label}}else{var i=this.resultList.select(this.resultList.selected);this.onSubmit({query:this.searchElement.input.value,data:i})}},clearResults:function(e,r){if(r===void 0&&(r=!1),!e||e.keyCode===27){var t=this.options,n=t.autoComplete;!r&&t.keepResult||(this.searchElement.input.value="",this.markers.clearLayers()),n&&this.resultList.clear()}},autoSearch:function(e){try{var r=this;if(F.indexOf(e.keyCode)>-1)return Promise.resolve();var t=e.target.value,n=r.options.provider,o=function(){if(t.length)return Promise.resolve(n.search({query:t})).then(function(i){i=i.slice(0,r.options.maxSuggestions),r.resultList.render(i,r.options.resultFormat)});r.resultList.clear()}();return Promise.resolve(o&&o.then?o.then(function(){}):void 0)}catch(i){return Promise.reject(i)}},onSubmit:function(e){try{var r=this;return r.resultList.clear(),Promise.resolve(r.options.provider.search(e)).then(function(t){t&&t.length>0&&r.showResult(t[0],e)})}catch(t){return Promise.reject(t)}},showResult:function(e,r){var t=this.options,n=t.autoClose,o=t.updateMap,i=this.markers.getLayers();i.length>=this.options.maxMarkers&&this.markers.removeLayer(i[0]);var s=this.addMarker(e,r);o&&this.centerMap(e),this.map.fireEvent("geosearch/showlocation",{location:e,marker:s}),n&&this.closeResults()},closeResults:function(){var e=this.searchElement.container;e.classList.contains("active")&&l(e,"active"),this.clearResults()},addMarker:function(e,r){var t=this,n=this.options,o=n.marker,i=n.showPopup,s=n.popupFormat,a=new c.Marker([e.y,e.x],o),h=e.label;return typeof s=="function"&&(h=s({query:r,result:e})),a.bindPopup(h),this.markers.addLayer(a),i&&a.openPopup(),o.draggable&&a.on("dragend",function(d){t.map.fireEvent("geosearch/marker/dragend",{location:a.getLatLng(),event:d})}),a},centerMap:function(e){var r=this.options,t=r.retainZoomLevel,n=r.animateZoom,o=e.bounds?new c.LatLngBounds(e.bounds):new c.LatLng(e.y,e.x).toBounds(10),i=o.isValid()?o:this.markers.getBounds();!t&&o.isValid()&&!e.bounds||t||!o.isValid()?this.map.setView(i.getCenter(),this.getZoom(),{animate:n}):this.map.fitBounds(i,{animate:n})},getZoom:function(){var e=this.options,r=e.zoomLevel;return e.retainZoomLevel?this.map.getZoom():r}};function O(){if(!C)throw new Error(P);var e=c.Control.extend(M);return L(e,[].slice.call(arguments))}(function(e){e[e.SEARCH=0]="SEARCH",e[e.REVERSE=1]="REVERSE"})(b||(b={}));var S,U=function(){function e(t){t===void 0&&(t={}),this.options=void 0,this.options=t}var r=e.prototype;return r.getParamString=function(t){t===void 0&&(t={});var n=p({},this.options.params,t);return Object.keys(n).map(function(o){return encodeURIComponent(o)+"="+encodeURIComponent(n[o])}).join("&")},r.getUrl=function(t,n){return t+"?"+this.getParamString(n)},r.search=function(t){try{var n=this,o=n.endpoint({query:t.query,type:b.SEARCH});return Promise.resolve(fetch(o)).then(function(i){return Promise.resolve(i.json()).then(function(s){return n.parse({data:s})})})}catch(i){return Promise.reject(i)}},e}();(function(e){e[e.INITIALIZED=0]="INITIALIZED",e[e.LOADING=1]="LOADING",e[e.SUCCESS=2]="SUCCESS",e[e.FAILURE=3]="FAILURE"})(S||(S={}));var D=function(e){function r(n){var o;n===void 0&&(n={}),(o=e.call(this,n)||this).searchUrl=void 0,o.reverseUrl=void 0;var i="https://nominatim.openstreetmap.org";return o.searchUrl=n.searchUrl||i+"/search",o.reverseUrl=n.reverseUrl||i+"/reverse",o}N(r,e);var t=r.prototype;return t.endpoint=function(n){var o=n.query,i=n.type,s=typeof o=="string"?{q:o}:o;return s.format="json",this.getUrl(i===b.REVERSE?this.reverseUrl:this.searchUrl,s)},t.parse=function(n){return(Array.isArray(n.data)?n.data:[n.data]).map(function(o){return{x:Number(o.lon),y:Number(o.lat),label:o.display_name,bounds:[[parseFloat(o.boundingbox[0]),parseFloat(o.boundingbox[2])],[parseFloat(o.boundingbox[1]),parseFloat(o.boundingbox[3])]],raw:o}})},r}(U);export{D as F,O as w};
