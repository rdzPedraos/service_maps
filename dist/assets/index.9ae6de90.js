import{V as M}from"./vue.6bd37196.js";import{l as d}from"./leaflet.a3cf53d3.js";import{l as C}from"./@maptiler.c31b084e.js";import{F as b,w as P}from"./leaflet-geosearch.38cb150e.js";import{L as $}from"./leaflet.locatecontrol.10a42b12.js";import"./@geoman-io.7e68aca6.js";import"./events.9fb9ca1f.js";import"./maplibre-gl.d000321f.js";import"./js-base64.cd2f9b33.js";import"./uuid.1b90e2d5.js";function re(){import("data:text/javascript,")}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function o(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerpolicy&&(a.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?a.credentials="include":r.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(r){if(r.ep)return;r.ep=!0;const a=o(r);fetch(r.href,a)}})();const m={MAPS_KEY:"q5xt6kuI8cht07Kp2VRt",MAP_PROVIDER:"maptiler"};function _(t,e){return d.map(t,e)}function h(){switch(m.MAP_PROVIDER){case"maptiler":return new C({apiKey:m.MAPS_KEY});case"openstreetmap":return d.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:18,attribution:'Map data \xA9 <a href="https://openstreetmap.org">OpenStreetMap</a> contributors'});default:throw new Error("Invalid MAP_PROVIDER")}}function k(t=[0,0]){return d.circleMarker(t,{color:"#fff",fillColor:"#007bff",fillOpacity:1,radius:10,weight:3,className:"pulse"})}function g(){const t=new b;return new P({provider:t,showMarker:!1,searchLabel:"Buscar direcci\xF3n...",notFoundMessage:"Sorry, that address could not be found.",style:"bar"})}function O(){return new $({position:"topleft",flyTo:!0,drawMarker:!1,enableHighAccuracy:!0})}const R=()=>{const t=d.Control.extend({onAdd:function(e){return e.pm.addControls({position:"topleft",drawText:!1,drawMarker:!1,drawRectangle:!0,drawCircle:!1,drawCircleMarker:!1,drawPolygon:!0,drawPolyline:!1,cutPolygon:!1,editMode:!0,dragMode:!0,removalMode:!0}),d.DomUtil.create("div")}});return new t};function v(t,e){e.forEach(o=>{t.addControl(o)})}function I(t){const e=t.location?[t.location.y,t.location.x]:[t.latlng.lat,t.latlng.lng];return{lat:e[0],lng:e[1]}}function L(t){return d.geoJSON(t)}function p(t,e,o,n,r,a,c,y){var i=typeof t=="function"?t.options:t;e&&(i.render=e,i.staticRenderFns=o,i._compiled=!0),n&&(i.functional=!0),a&&(i._scopeId="data-v-"+a);var s;if(c?(s=function(l){l=l||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!l&&typeof __VUE_SSR_CONTEXT__<"u"&&(l=__VUE_SSR_CONTEXT__),r&&r.call(this,l),l&&l._registeredComponents&&l._registeredComponents.add(c)},i._ssrRegister=s):r&&(s=y?function(){r.call(this,(i.functional?this.parent:this).$root.$options.shadowRoot)}:r),s)if(i.functional){i._injectStyles=s;var S=i.render;i.render=function(w,f){return s.call(f),S(w,f)}}else{var u=i.beforeCreate;i.beforeCreate=u?[].concat(u,s):[s]}return{exports:t,options:i}}const N={data(){return{map:null,marker:null,coords:null}},mounted(){this.initializeMap(),this.map.on("locationfound",this.moveMarker),this.map.on("click",this.moveMarker),this.map.on("geosearch/showlocation",this.moveMarker),this.map.locate({setView:!0})},methods:{initializeMap(){const t=_("user"),e=k();v(t,[e,h(),g(),O()]),this.map=t,this.marker=e},moveMarker(t){const e=I(t);this.marker.setLatLng(e),this.coords=e}}};var x=function(){var e=this,o=e._self._c;return o("div",[o("span",{staticStyle:{color:"white"}},[e._v(e._s(e.coords))]),o("div",{staticStyle:{height:"800px"},attrs:{id:"user"}})])},E=[],A=p(N,x,E,!1,null,null,null,null);const F=A.exports,V={props:{polygon:{type:Object}},data(){return{fields:{name:"",description:"",color:"#3388ff"}}},watch:{polygon:{handler(t){this.fields={...t.metadata}},immediate:!0},"fields.color":{handler(t){this.$emit("onChangecolor",t)}}},methods:{onDelete(){this.$emit("delete",this.polygon)},onCancel(){this.$emit("cancel",this.polygon)},onSave(){const{polygon:t,fields:e}=this,o={...t,metadata:{...t.metadata,...e}};this.$emit("save",o)}}};var D=function(){var e=this,o=e._self._c;return o("div",[o("label",[e._v(" Nombre: "),o("input",{directives:[{name:"model",rawName:"v-model",value:e.fields.name,expression:"fields.name"}],attrs:{type:"text"},domProps:{value:e.fields.name},on:{input:function(n){n.target.composing||e.$set(e.fields,"name",n.target.value)}}})]),o("br"),o("br"),o("label",[e._v(" Descripci\xF3n: "),o("input",{directives:[{name:"model",rawName:"v-model",value:e.fields.description,expression:"fields.description"}],attrs:{type:"text"},domProps:{value:e.fields.description},on:{input:function(n){n.target.composing||e.$set(e.fields,"description",n.target.value)}}})]),o("br"),o("br"),o("label",[e._v(" Color: "),o("input",{directives:[{name:"model",rawName:"v-model",value:e.fields.color,expression:"fields.color"}],attrs:{type:"color"},domProps:{value:e.fields.color},on:{input:function(n){n.target.composing||e.$set(e.fields,"color",n.target.value)}}})]),o("br"),o("br"),o("button",{on:{click:e.onSave}},[e._v("Guardar")]),o("button",{on:{click:e.onCancel}},[e._v("Cancelar")]),o("button",{on:{click:e.onDelete}},[e._v("Eliminar")])])},T=[],z=p(V,D,T,!1,null,null,null,null);const J=z.exports,U={components:{InfoBox:J},data(){return{map:null,polygonSelected:null}},mounted(){this.initializeMap(),this.loadPolygons(),this.map.on("pm:create",t=>{const{editPolygonInfo:e}=this,o=t.layer;o.metadata={id:"area-"+Date.now(),shape:o.toGeoJSON(),color:"#3388ff"},o.on("click",()=>e(o)),o.fire("click")})},watch:{polygonSelected(t,e){(e==null?void 0:e.metadata.id)&&!localStorage.getItem(e.metadata.id)&&this.map.removeLayer(e)}},methods:{initializeMap(){const t=_("admin");v(t,[h(),R(),g()]),t.locate({setView:!0}),this.map=t},deletePolygon(t){localStorage.removeItem(t.metadata.id),this.polygonSelected=null},editPolygonInfo(t){const e=this.getPolygon(t.metadata.id);e&&(t.metadata=e),this.polygonSelected=t},cancelPolygon(){this.polygonSelected=null},savePolygon(t){const{metadata:e}=t,o=JSON.stringify(t.metadata);localStorage.setItem(e.id,o),this.polygonSelected=null},setColor(t){this.polygonSelected.setStyle({color:t})},loadPolygons(){const{editPolygonInfo:t,getPolygons:e}=this;e().forEach(n=>{const r=L(n.shape);r.setStyle({color:n.color}),r.metadata=n,r.on("click",()=>t(r)),this.map.addLayer(r)})},getPolygons(){const t=[];for(let e=0;e<localStorage.length;e++){let o=localStorage.key(e);o.startsWith("area-")&&t.push(JSON.parse(localStorage.getItem(o)))}return t},getPolygon(t){return JSON.parse(localStorage.getItem(t))}}};var K=function(){var e=this,o=e._self._c;return o("div",{staticClass:"admin__container"},[o("div",{staticStyle:{height:"800px"},attrs:{id:"admin"}}),e.polygonSelected?o("InfoBox",{staticClass:"admin__edit",attrs:{polygon:e.polygonSelected},on:{save:e.savePolygon,cancel:e.cancelPolygon,delete:e.deletePolygon,onChangecolor:e.setColor}}):e._e()],1)},B=[],G=p(U,K,B,!1,null,null,null,null);const q=G.exports,W={components:{MapUser:F,MapAdmin:q}};var X=function(){var e=this,o=e._self._c;return o("div",[o("p",{staticStyle:{color:"white"}},[e._v("User")]),o("MapUser"),o("br"),o("br"),o("br"),o("p",{staticStyle:{color:"white"}},[e._v("Admin")]),o("MapAdmin")],1)},Y=[],H=p(W,X,Y,!1,null,null,null,null);const Z=H.exports,Q={__name:"App",setup(t){return{__sfc:!0,ShowMaps:Z}}};var j=function(){var e=this,o=e._self._c,n=e._self._setupProxy;return o("div",{attrs:{id:"app"}},[o(n.ShowMaps)],1)},ee=[],te=p(Q,j,ee,!1,null,null,null,null);const oe=te.exports;new M({render:t=>t(oe)}).$mount("#app");export{re as __vite_legacy_guard};
