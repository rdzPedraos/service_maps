import{m as y}from"./maplibre-gl.d000321f.js";import{g as Ht}from"./js-base64.cd2f9b33.js";import{e as Vt}from"./events.9fb9ca1f.js";import{v as Gt}from"./uuid.1b90e2d5.js";import{l as v}from"./leaflet.a3cf53d3.js";function jt(){return typeof self<"u"?fetch.bind(self):typeof global<"u"&&global.fetch?global.fetch:null}class Kt{constructor(){this._apiKey="",this._fetch=jt(),this.tileCacheSize=200}set apiKey(e){this._apiKey=e}get apiKey(){return this._apiKey}set fetch(e){this._fetch=e}get fetch(){return this._fetch}}const he=new Kt,Wt={AUTO:"auto",ALBANIAN:"sq",ARABIC:"ar",ARMENIAN:"hy",AZERBAIJANI:"az",BELORUSSIAN:"be",BOSNIAN:"bs",BRETON:"br",BULGARIAN:"bg",CATALAN:"ca",CHINESE:"zh",CROATIAN:"hr",CZECH:"cs",DANISH:"da",DUTCH:"nl",ENGLISH:"en",ESPERANTO:"eo",ESTONIAN:"et",FINNISH:"fi",FRENCH:"fr",FRISIAN:"fy",GEORGIAN:"ka",GERMAN:"de",GREEK:"el",HEBREW:"he",HUNGARIAN:"hu",ICELANDIC:"is",IRISH:"ga",ITALIAN:"it",JAPANESE:"ja",KANNADA:"kn",KAZAKH:"kk",KOREAN:"ko",ROMAN_LATIN:"la",LATVIAN:"lv",LITHUANIAN:"lt",LUXEMBOURGISH:"lb",MACEDONIAN:"mk",MALTESE:"mt",NORWEGIAN:"no",POLISH:"pl",PORTUGUESE:"pt",ROMANIAN:"ro",ROMANSH:"rm",RUSSIAN:"ru",SCOTTISH_GAELIC:"gd",SERBIAN_CYRILLIC:"sr",SLOVAK:"sk",SLOVENE:"sl",SPANISH:"es",SWEDISH:"sv",THAI:"th",TURKISH:"tr",UKRAINIAN:"uk",WELSH:"cy"};new Set(Object.values(Wt));async function Zt(t,e={}){if(he.fetch===null)throw new Error("The fetch function was not found. If on NodeJS < 18 please specify the fetch function with config.fetch");if(new URL(t).searchParams.get("key").trim()==="")throw new Error("The MapTiler Cloud API key is missing. Set it in `config.apiKey` or get one for free at https://maptiler.com");return he.fetch(t,e)}const At={maptilerApiURL:"https://api.maptiler.com/",mapStyle:"streets-v2"};Object.freeze(At);class Yt extends Error{constructor(e,r=""){super(`Call to enpoint ${e.url} failed with the status code ${e.status}. ${r}`),this.res=e}}const $e={403:"Key is missing, invalid or restricted"};async function qt(t={}){var n;const e=new URL("geolocation/ip.json",At.maptilerApiURL);e.searchParams.set("key",(n=t.apiKey)!=null?n:he.apiKey);const r=e.toString(),a=await Zt(r);if(!a.ok)throw new Yt(a,a.status in $e?$e[a.status]:"");return await a.json()}const He={info:qt};function St(t){const e=/^maptiler:\/\/(.*)/;let r;const a=t.trim();let o;return a.startsWith("http://")||a.startsWith("https://")?o=a:(r=e.exec(a))!==null?o=`https://api.maptiler.com/maps/${r[1]}/style.json`:o=`https://api.maptiler.com/maps/${a}/style.json`,o}class wt{constructor(e,r,a,o,n,i){this.name=e,this.variantType=r,this.id=a,this.referenceStyle=o,this.description=n,this.imageURL=i}getName(){return this.name}getFullName(){return`${this.referenceStyle.getName()} ${this.name}`}getType(){return this.variantType}getId(){return this.id}getDescription(){return this.description}getReferenceStyle(){return this.referenceStyle}hasVariant(e){return this.referenceStyle.hasVariant(e)}getVariant(e){return this.referenceStyle.getVariant(e)}getVariants(){return this.referenceStyle.getVariants().filter(e=>e!==this)}getImageURL(){return this.imageURL}getExpandedStyleURL(){return St(this.getId())}}class Tt{constructor(e,r){this.name=e,this.id=r,this.variants={},this.orderedVariants=[]}getName(){return this.name}getId(){return this.id}addVariant(e){this.variants[e.getType()]=e,this.orderedVariants.push(e)}hasVariant(e){return e in this.variants}getVariant(e){return e in this.variants?this.variants[e]:this.orderedVariants[0]}getVariants(){return Object.values(this.variants)}getDefaultVariant(){return this.orderedVariants[0]}}const Ce=[{referenceStyleID:"STREETS",name:"Streets",description:"",variants:[{id:"streets-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"streets-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"streets-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""},{id:"streets-v2-night",name:"Night",variantType:"NIGHT",description:"",imageURL:""},{id:"streets-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""}]},{referenceStyleID:"OUTDOOR",name:"Outdoor",description:"",variants:[{id:"outdoor-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"outdoor-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""}]},{referenceStyleID:"WINTER",name:"Winter",description:"",variants:[{id:"winter-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"winter-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""}]},{referenceStyleID:"SATELLITE",name:"Satellite",description:"",variants:[{id:"satellite",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"HYBRID",name:"Hybrid",description:"",variants:[{id:"hybrid",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"BASIC",name:"Basic",description:"",variants:[{id:"basic-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"basic-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"basic-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"BRIGHT",name:"Bright",description:"",variants:[{id:"bright-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"bright-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"bright-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""},{id:"bright-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""}]},{referenceStyleID:"OPENSTREETMAP",name:"OpenStreetMap",description:"",variants:[{id:"openstreetmap",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"TOPO",name:"Topo",description:"",variants:[{id:"topo-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"topo-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"topo-v2-shiny",name:"Shiny",variantType:"SHINY",description:"",imageURL:""},{id:"topo-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""},{id:"topo-v2-topographique",name:"Topographique",variantType:"TOPOGRAPHIQUE",description:"",imageURL:""}]},{referenceStyleID:"VOYAGER",name:"Voyager",description:"",variants:[{id:"voyager-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"voyager-v2-darkmatter",name:"Darkmatter",variantType:"DARK",description:"",imageURL:""},{id:"voyager-v2-positron",name:"Positron",variantType:"LIGHT",description:"",imageURL:""},{id:"voyager-v2-vintage",name:"Vintage",variantType:"VINTAGE",description:"",imageURL:""}]},{referenceStyleID:"TONER",name:"Toner",description:"",variants:[{id:"toner-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"toner-v2-background",name:"Background",variantType:"BACKGROUND",description:"",imageURL:""},{id:"toner-v2-lite",name:"Lite",variantType:"LITE",description:"",imageURL:""},{id:"toner-v2-lines",name:"Lines",variantType:"LINES",description:"",imageURL:""}]},{referenceStyleID:"DATAVIZ",name:"Dataviz",description:"",variants:[{id:"dataviz",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"dataviz-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"dataviz-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"BACKDROP",name:"Backdrop",description:"",variants:[{id:"backdrop",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"backdrop-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"backdrop-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"OCEAN",name:"Ocean",description:"",variants:[{id:"ocean",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]}];function Jt(t){return new Proxy(t,{get(e,r,a){return e.hasVariant(r)?e.getVariant(r):r.toString().toUpperCase()===r?t.getDefaultVariant():Reflect.get(e,r,a)}})}function Xt(){const t={};for(let e=0;e<Ce.length;e+=1){const r=Ce[e],a=Jt(new Tt(r.name,r.referenceStyleID));for(let o=0;o<r.variants.length;o+=1){const n=r.variants[o],i=new wt(n.name,n.variantType,n.id,a,n.description,n.imageURL);a.addVariant(i)}t[r.referenceStyleID]=a}return t}const Ee=Xt(),A={VISITOR:"visitor",VISITOR_ENGLISH:"visitor_en",STYLE:"style",AUTO:"auto",STYLE_LOCK:"style_lock",LATIN:"name:latin",NON_LATIN:"name:nonlatin",LOCAL:"name",INTERNATIONAL:"name_int",ALBANIAN:"name:sq",AMHARIC:"name:am",ARABIC:"name:ar",ARMENIAN:"name:hy",AZERBAIJANI:"name:az",BASQUE:"name:eu",BELORUSSIAN:"name:be",BENGALI:"name:bn",BOSNIAN:"name:bs",BRETON:"name:br",BULGARIAN:"name:bg",CATALAN:"name:ca",CHINESE:"name:zh",TRADITIONAL_CHINESE:"name:zh-Hant",SIMPLIFIED_CHINESE:"name:zh-Hans",CORSICAN:"name:co",CROATIAN:"name:hr",CZECH:"name:cs",DANISH:"name:da",DUTCH:"name:nl",ENGLISH:"name:en",ESPERANTO:"name:eo",ESTONIAN:"name:et",FINNISH:"name:fi",FRENCH:"name:fr",FRISIAN:"name:fy",GEORGIAN:"name:ka",GERMAN:"name:de",GREEK:"name:el",HEBREW:"name:he",HINDI:"name:hi",HUNGARIAN:"name:hu",ICELANDIC:"name:is",INDONESIAN:"name:id",IRISH:"name:ga",ITALIAN:"name:it",JAPANESE:"name:ja",JAPANESE_HIRAGANA:"name:ja-Hira",JAPANESE_KANA:"name:ja_kana",JAPANESE_LATIN:"name:ja_rm",JAPANESE_2018:"name:ja-Latn",KANNADA:"name:kn",KAZAKH:"name:kk",KOREAN:"name:ko",KOREAN_LATIN:"name:ko-Latn",KURDISH:"name:ku",ROMAN_LATIN:"name:la",LATVIAN:"name:lv",LITHUANIAN:"name:lt",LUXEMBOURGISH:"name:lb",MACEDONIAN:"name:mk",MALAYALAM:"name:ml",MALTESE:"name:mt",NORWEGIAN:"name:no",OCCITAN:"name:oc",PERSIAN:"name:fa",POLISH:"name:pl",PORTUGUESE:"name:pt",PUNJABI:"name:pa",WESTERN_PUNJABI:"name:pnb",ROMANIAN:"name:ro",ROMANSH:"name:rm",RUSSIAN:"name:ru",SCOTTISH_GAELIC:"name:gd",SERBIAN_CYRILLIC:"name:sr",SERBIAN_LATIN:"name:sr-Latn",SLOVAK:"name:sk",SLOVENE:"name:sl",SPANISH:"name:es",SWEDISH:"name:sv",TAMIL:"name:ta",TELUGU:"name:te",THAI:"name:th",TURKISH:"name:tr",UKRAINIAN:"name:uk",URDU:"name:ur",VIETNAMIAN_LATIN:"name:vi",WELSH:"name:cy"},Qt=new Set(Object.values(A));function Ve(t){return Qt.has(t)}const er=new Set(Object.values(A));function Ge(){if(typeof navigator>"u")return`name:${Intl.DateTimeFormat().resolvedOptions().locale.split("-")[0]}`;const t=Array.from(new Set(navigator.languages.map(e=>`name:${e.split("-")[0]}`))).filter(e=>er.has(e));return t.length?t[0]:A.LOCAL}const J={maptilerLogoURL:"https://api.maptiler.com/resources/logo.svg",maptilerURL:"https://www.maptiler.com/",maptilerApiHost:"api.maptiler.com",rtlPluginURL:"https://cdn.maptiler.com/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.min.js",primaryLanguage:A.STYLE,secondaryLanguage:A.LOCAL,terrainSourceURL:"https://api.maptiler.com/tiles/terrain-rgb-v2/tiles.json",terrainSourceId:"maptiler-terrain"};Object.freeze(J);var tr=Object.defineProperty,rr=(t,e,r)=>e in t?tr(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ge=(t,e,r)=>(rr(t,typeof e!="symbol"?e+"":e,r),r);const Rt=Gt();class ar extends Vt.exports{constructor(){super(),ge(this,"primaryLanguage",J.primaryLanguage),ge(this,"secondaryLanguage"),ge(this,"session",!0),ge(this,"_unit","metric"),ge(this,"_apiKey","")}set unit(e){this._unit=e,this.emit("unit",e)}get unit(){return this._unit}set apiKey(e){this._apiKey=e,he.apiKey=e,this.emit("apiKey",e)}get apiKey(){return this._apiKey}set fetch(e){he.fetch=e}get fetch(){return he.fetch}}const Z=new ar;class or extends y.LogoControl{onAdd(e){return super.onAdd(e)}}var nr=Object.defineProperty,ir=(t,e,r)=>e in t?nr(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,je=(t,e,r)=>(ir(t,typeof e!="symbol"?e+"":e,r),r);class Ke extends or{constructor(e={}){var r,a;super(e),je(this,"logoURL",""),je(this,"linkURL",""),this.logoURL=(r=e.logoURL)!=null?r:J.maptilerLogoURL,this.linkURL=(a=e.linkURL)!=null?a:J.maptilerURL}onAdd(e){var r;this._map=e,this._compact=(r=this.options.compact)!=null?r:!1,this._container=window.document.createElement("div"),this._container.className="maplibregl-ctrl";const a=window.document.createElement("a");return a.style.backgroundRepeat="no-repeat",a.style.cursor="pointer",a.style.display="block",a.style.height="23px",a.style.margin="0 0 -4px -4px",a.style.overflow="hidden",a.style.width="88px",a.style.backgroundImage=`url(${this.logoURL})`,a.style.backgroundSize="100px 30px",a.style.width="100px",a.style.height="30px",a.target="_blank",a.rel="noopener",a.href=this.linkURL,a.setAttribute("aria-label","MapTiler logo"),a.setAttribute("rel","noopener"),this._container.appendChild(a),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}}var lr=Object.defineProperty,We=Object.getOwnPropertySymbols,sr=Object.prototype.hasOwnProperty,cr=Object.prototype.propertyIsEnumerable,Ze=(t,e,r)=>e in t?lr(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ye=(t,e)=>{for(var r in e||(e={}))sr.call(e,r)&&Ze(t,r,e[r]);if(We)for(var r of We(e))cr.call(e,r)&&Ze(t,r,e[r]);return t};function ur(){y.getRTLTextPluginStatus()==="unavailable"&&y.setRTLTextPlugin(J.rtlPluginURL,t=>{t&&console.error(t)},!0)}function pr(t,e){t.forEach(r=>{typeof e[r]=="function"&&(e[r]=e[r].bind(e))})}function ae(t,e,r){const a=window.document.createElement(t);return e!==void 0&&(a.className=e),r&&r.appendChild(a),a}function It(t){t.parentNode&&t.parentNode.removeChild(t)}function qe(t,e){let r=null;try{r=new URL(t)}catch(a){return{url:t}}return r.host===J.maptilerApiHost&&(r.searchParams.has("key")||r.searchParams.append("key",Z.apiKey),Z.session&&r.searchParams.append("mtsid",Rt)),{url:r.href}}function Je(t){return function(e,r){var a;if(t!==void 0){const o=t(e,r),n=qe((a=o==null?void 0:o.url)!=null?a:"");return Ye(Ye({},o),n)}else return qe(e)}}function Ct(){return Math.random().toString(36).substring(2)}function Ae(t){return/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/gi.test(t)}function hr(t){try{return JSON.parse(t)}catch(e){}return null}function Xe(t){return t?typeof t=="string"||t instanceof String?!t.startsWith("http")&&t.toLowerCase().includes(".json")?t:St(t):t instanceof wt?t.getExpandedStyleURL():t instanceof Tt?t.getDefaultVariant().getExpandedStyleURL():t:Ee[Ce[0].referenceStyleID].getDefaultVariant().getExpandedStyleURL()}var mr=Object.defineProperty,dr=(t,e,r)=>e in t?mr(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Re=(t,e,r)=>(dr(t,typeof e!="symbol"?e+"":e,r),r);class fr{constructor(){Re(this,"_map"),Re(this,"_container"),Re(this,"_terrainButton"),pr(["_toggleTerrain","_updateTerrainIcon"],this)}onAdd(e){return this._map=e,this._container=ae("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=ae("button","maplibregl-ctrl-terrain",this._container),ae("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){It(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}_toggleTerrain(){this._map.hasTerrain()?this._map.disableTerrain():this._map.enableTerrain(),this._updateTerrainIcon()}_updateTerrainIcon(){this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.hasTerrain()?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))}}class gr extends y.NavigationControl{onAdd(e){return super.onAdd(e)}}var yr=Object.defineProperty,vr=(t,e,r)=>e in t?yr(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,_r=(t,e,r)=>(vr(t,typeof e!="symbol"?e+"":e,r),r);class Lr extends gr{constructor(){super({showCompass:!0,showZoom:!0,visualizePitch:!0}),_r(this,"_rotateCompassArrow",()=>{const e=this.options.visualizePitch?`scale(${Math.min(1.5,1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5))}) rotateX(${Math.min(70,this._map.transform.pitch)}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=e}),this._compass.removeEventListener("click",this._compass.clickFunction),this._compass.addEventListener("click",e=>{this._map.getPitch()===0?this._map.easeTo({pitch:Math.min(this._map.getMaxPitch(),80)}):this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:e}):this._map.resetNorth({},{originalEvent:e})})}_createButton(e,r){const a=super._createButton(e,r);return a.clickFunction=r,a}}class Ar extends y.GeolocateControl{onAdd(e){return super.onAdd(e)}}var Sr=Object.defineProperty,wr=Object.defineProperties,Tr=Object.getOwnPropertyDescriptors,Qe=Object.getOwnPropertySymbols,Rr=Object.prototype.hasOwnProperty,Ir=Object.prototype.propertyIsEnumerable,be=(t,e,r)=>e in t?Sr(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Cr=(t,e)=>{for(var r in e||(e={}))Rr.call(e,r)&&be(t,r,e[r]);if(Qe)for(var r of Qe(e))Ir.call(e,r)&&be(t,r,e[r]);return t},Er=(t,e)=>wr(t,Tr(e)),ye=(t,e,r)=>(be(t,typeof e!="symbol"?e+"":e,r),r);const et=y.Marker,tt=y.LngLat,br=y.LngLatBounds;class Pr extends Ar{constructor(){super(...arguments),ye(this,"lastUpdatedCenter",new tt(0,0)),ye(this,"_updateCamera",e=>{var r,a,o;const n=new tt(e.coords.longitude,e.coords.latitude),i=e.coords.accuracy,l=this._map.getBearing(),s=Er(Cr({bearing:l},this.options.fitBoundsOptions),{linear:!0}),h=this._map.getZoom();h>((o=(a=(r=this.options)==null?void 0:r.fitBoundsOptions)==null?void 0:a.maxZoom)!=null?o:30)&&(s.zoom=h),this._map.fitBounds(br.fromLngLat(n,i),s,{geolocateSource:!0});let p=!1;const c=()=>{p=!0};this._map.once("click",c),this._map.once("dblclick",c),this._map.once("dragstart",c),this._map.once("mousedown",c),this._map.once("touchstart",c),this._map.once("wheel",c),this._map.once("moveend",()=>{this._map.off("click",c),this._map.off("dblclick",c),this._map.off("dragstart",c),this._map.off("mousedown",c),this._map.off("touchstart",c),this._map.off("wheel",c),!p&&(this.lastUpdatedCenter=this._map.getCenter())})}),ye(this,"_setupUI",e=>{if(this.lastUpdatedCenter=this._map.getCenter(),this._container.addEventListener("contextmenu",r=>r.preventDefault()),this._geolocateButton=ae("button","maplibregl-ctrl-geolocate",this._container),ae("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",e===!1){const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r)}else{const r=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=ae("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new et({element:this._dotElement}),this._circleElement=ae("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new et({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("move",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("moveend",r=>{const a=r.originalEvent&&r.originalEvent.type==="resize",o=this.lastUpdatedCenter.distanceTo(this._map.getCenter());!r.geolocateSource&&this._watchState==="ACTIVE_LOCK"&&!a&&o>1&&(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new Event("trackuserlocationend")))})}),ye(this,"_onZoom",()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()})}_updateCircleRadius(){if(this._watchState!=="BACKGROUND"&&this._watchState!=="ACTIVE_LOCK")return;const e=[this._lastKnownPosition.coords.longitude,this._lastKnownPosition.coords.latitude],r=this._map.project(e),a=this._map.unproject([r.x,r.y]),o=this._map.unproject([r.x+20,r.y]),n=a.distanceTo(o)/20,i=Math.ceil(2*this._accuracy/n);this._circleElement.style.width=`${i}px`,this._circleElement.style.height=`${i}px`}}class Or extends y.AttributionControl{onAdd(e){return super.onAdd(e)}}class Nr extends y.ScaleControl{onAdd(e){return super.onAdd(e)}}class Ur extends y.FullscreenControl{onAdd(e){return super.onAdd(e)}}var xr=Object.defineProperty,Dr=Object.defineProperties,Mr=Object.getOwnPropertyDescriptors,rt=Object.getOwnPropertySymbols,zr=Object.prototype.hasOwnProperty,Fr=Object.prototype.propertyIsEnumerable,Pe=(t,e,r)=>e in t?xr(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,me=(t,e)=>{for(var r in e||(e={}))zr.call(e,r)&&Pe(t,r,e[r]);if(rt)for(var r of rt(e))Fr.call(e,r)&&Pe(t,r,e[r]);return t},at=(t,e)=>Dr(t,Mr(e)),Br=(t,e,r)=>(Pe(t,typeof e!="symbol"?e+"":e,r),r),De=(t,e,r)=>{if(!e.has(t))throw TypeError("Cannot "+r)},S=(t,e,r)=>(De(t,e,"read from private field"),r?r.call(t):e.get(t)),Q=(t,e,r)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,r)},pe=(t,e,r,a)=>(De(t,e,"write to private field"),a?a.call(t,r):e.set(t,r),r),j=(t,e,r)=>(De(t,e,"access private method"),r),K,te,ne,Et,ie,Y,_e,Oe,bt,W,q,Ne,Pt;class Ie{constructor(e,r){Q(this,Oe),Q(this,W),Q(this,Ne),Q(this,K,void 0),Br(this,"map"),Q(this,te,void 0),Q(this,ne,void 0),Q(this,Et,void 0),Q(this,ie,void 0),Q(this,Y,!1),Q(this,_e,void 0);var a;e.style!==void 0&&pe(this,Y,!0),pe(this,K,at(me(at(me({zoomAdjust:-4,position:"top-right"},r),{forceNoAttributionControl:!0,attributionControl:!1,navigationControl:!1,geolocateControl:!1,maptilerLogo:!1,minimap:!1,hash:!1,pitchAdjust:!1}),e),{containerStyle:me({border:"1px solid #000",width:"400px",height:"300px"},(a=e.containerStyle)!=null?a:{})})),e.lockZoom!==void 0&&(S(this,K).minZoom=e.lockZoom,S(this,K).maxZoom=e.lockZoom)}setStyle(e,r){S(this,Y)||this.map.setStyle(e,r),j(this,W,q).call(this)}addLayer(e,r){return S(this,Y)||this.map.addLayer(e,r),j(this,W,q).call(this),this.map}moveLayer(e,r){return S(this,Y)||this.map.moveLayer(e,r),j(this,W,q).call(this),this.map}removeLayer(e){return S(this,Y)||this.map.removeLayer(e),j(this,W,q).call(this),this}setLayerZoomRange(e,r,a){return S(this,Y)||this.map.setLayerZoomRange(e,r,a),j(this,W,q).call(this),this}setFilter(e,r,a){return S(this,Y)||this.map.setFilter(e,r,a),j(this,W,q).call(this),this}setPaintProperty(e,r,a,o){return S(this,Y)||this.map.setPaintProperty(e,r,a,o),j(this,W,q).call(this),this}setLayoutProperty(e,r,a,o){return S(this,Y)||this.map.setLayoutProperty(e,r,a,o),j(this,W,q).call(this),this}setGlyphs(e,r){return S(this,Y)||this.map.setGlyphs(e,r),j(this,W,q).call(this),this}onAdd(e){pe(this,te,e),pe(this,ne,ae("div","maplibregl-ctrl maplibregl-ctrl-group"));for(const[r,a]of Object.entries(S(this,K).containerStyle))S(this,ne).style.setProperty(r,a);return S(this,K).container=S(this,ne),S(this,K).zoom=e.getZoom()+S(this,K).zoomAdjust,this.map=new Ot(S(this,K)),this.map.once("style.load",()=>{this.map.resize()}),this.map.once("load",()=>{j(this,Oe,bt).call(this,S(this,K).parentRect),pe(this,_e,j(this,Ne,Pt).call(this))}),S(this,ne)}onRemove(){var e;(e=S(this,_e))==null||e.call(this),It(S(this,ne))}}K=new WeakMap;te=new WeakMap;ne=new WeakMap;Et=new WeakMap;ie=new WeakMap;Y=new WeakMap;_e=new WeakMap;Oe=new WeakSet;bt=function(t){t===void 0||t.linePaint===void 0&&t.fillPaint===void 0||(pe(this,ie,{type:"Feature",properties:{name:"parentRect"},geometry:{type:"Polygon",coordinates:[[[],[],[],[],[]]]}}),this.map.addSource("parentRect",{type:"geojson",data:S(this,ie)}),(t.lineLayout!==void 0||t.linePaint!==void 0)&&this.map.addLayer({id:"parentRectOutline",type:"line",source:"parentRect",layout:me({},t.lineLayout),paint:me({"line-color":"#FFF","line-width":1,"line-opacity":.85},t.linePaint)}),t.fillPaint!==void 0&&this.map.addLayer({id:"parentRectFill",type:"fill",source:"parentRect",layout:{},paint:me({"fill-color":"#08F","fill-opacity":.135},t.fillPaint)}),j(this,W,q).call(this))};W=new WeakSet;q=function(){if(S(this,ie)===void 0)return;const{devicePixelRatio:t}=window,e=S(this,te).getCanvas(),r=e.width/t,a=e.height/t,o=S(this,te).unproject.bind(S(this,te)),n=o([0,0]),i=o([r,0]),l=o([0,a]),s=o([r,a]);S(this,ie).geometry.coordinates=[[l.toArray(),s.toArray(),i.toArray(),n.toArray(),l.toArray()]],this.map.getSource("parentRect").setData(S(this,ie))};Ne=new WeakSet;Pt=function(){const{pitchAdjust:t}=S(this,K),e=()=>{n("parent")},r=()=>{n("minimap")},a=()=>{S(this,te).on("move",e),this.map.on("move",r)},o=()=>{S(this,te).off("move",e),this.map.off("move",r)},n=i=>{var l;o();const s=i==="parent"?S(this,te):this.map,h=i==="parent"?this.map:S(this,te),p=s.getCenter(),c=s.getZoom()+((l=S(this,K).zoomAdjust)!=null?l:-4)*(i==="parent"?1:-1),u=s.getBearing(),m=s.getPitch();h.jumpTo({center:p,zoom:c,bearing:u,pitch:t?m:0}),j(this,W,q).call(this),a()};return a(),()=>{o()}};var kr=Object.defineProperty,$r=Object.defineProperties,Hr=Object.getOwnPropertyDescriptors,ot=Object.getOwnPropertySymbols,Vr=Object.prototype.hasOwnProperty,Gr=Object.prototype.propertyIsEnumerable,Ue=(t,e,r)=>e in t?kr(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,jr=(t,e)=>{for(var r in e||(e={}))Vr.call(e,r)&&Ue(t,r,e[r]);if(ot)for(var r of ot(e))Gr.call(e,r)&&Ue(t,r,e[r]);return t},Kr=(t,e)=>$r(t,Hr(e)),re=(t,e,r)=>(Ue(t,typeof e!="symbol"?e+"":e,r),r),ee=(t,e,r)=>new Promise((a,o)=>{var n=s=>{try{l(r.next(s))}catch(h){o(h)}},i=s=>{try{l(r.throw(s))}catch(h){o(h)}},l=s=>s.done?a(s.value):Promise.resolve(s.value).then(n,i);l((r=r.apply(t,e)).next())});const Wr={POINT:"POINT",COUNTRY:"COUNTRY"};class Ot extends y.Map{constructor(e){var r,a,o;e.apiKey&&(Z.apiKey=e.apiKey);const n=Xe(e.style),i=location.hash;Z.apiKey||console.warn("MapTiler Cloud API key is not set. Visit https://maptiler.com and try Cloud for free!"),super(Kr(jr({},e),{style:n,maplibreLogo:!1,transformRequest:Je(e.transformRequest)})),re(this,"isTerrainEnabled",!1),re(this,"terrainExaggeration",1),re(this,"primaryLanguage"),re(this,"terrainGrowing",!1),re(this,"terrainFlattening",!1),re(this,"minimap"),re(this,"forceLanguageUpdate"),re(this,"languageAlwaysBeenStyle"),re(this,"isReady",!1),this.primaryLanguage=(r=e.language)!=null?r:Z.primaryLanguage,this.forceLanguageUpdate=!(this.primaryLanguage===A.STYLE||this.primaryLanguage===A.STYLE_LOCK),this.languageAlwaysBeenStyle=this.primaryLanguage===A.STYLE,this.terrainExaggeration=(a=e.terrainExaggeration)!=null?a:this.terrainExaggeration,this.once("styledata",()=>ee(this,null,function*(){if(!e.geolocate||e.center||e.hash&&!!i)return;try{if(e.geolocate===Wr.COUNTRY){yield this.fitToIpBounds();return}}catch(m){console.warn(m.message)}let c;try{yield this.centerOnIpPoint(e.zoom),c=this.getCameraHash()}catch(m){console.warn(m.message)}(yield navigator.permissions.query({name:"geolocation"})).state==="granted"&&navigator.geolocation.getCurrentPosition(m=>{c===this.getCameraHash()&&(this.terrain?this.easeTo({center:[m.coords.longitude,m.coords.latitude],zoom:e.zoom||12,duration:2e3}):this.once("terrain",()=>{this.easeTo({center:[m.coords.longitude,m.coords.latitude],zoom:e.zoom||12,duration:2e3})}))},null,{maximumAge:24*3600*1e3,timeout:5e3,enableHighAccuracy:!1})})),this.on("styledata",()=>{this.setPrimaryLanguage(this.primaryLanguage)}),this.on("styledata",()=>{this.getTerrain()===null&&this.isTerrainEnabled&&this.enableTerrain(this.terrainExaggeration)}),this.once("load",()=>ee(this,null,function*(){ur()})),this.once("load",()=>ee(this,null,function*(){let c={logo:null};try{const u=Object.keys(this.style.sourceCaches).map(f=>this.getSource(f)).filter(f=>f&&"url"in f&&typeof f.url=="string"&&(f==null?void 0:f.url.includes("tiles.json"))),m=new URL(u[0].url);m.searchParams.has("key")||m.searchParams.append("key",Z.apiKey),c=yield(yield fetch(m.href)).json()}catch(u){}if(e.forceNoAttributionControl!==!0)if("logo"in c&&c.logo){const u=c.logo;this.addControl(new Ke({logoURL:u}),e.logoPosition),e.attributionControl===!1&&this.addControl(new Or({customAttribution:e.customAttribution}))}else e.maptilerLogo&&this.addControl(new Ke,e.logoPosition);if(e.scaleControl){const u=e.scaleControl===!0||e.scaleControl===void 0?"bottom-right":e.scaleControl,m=new Nr({unit:Z.unit});this.addControl(m,u),Z.on("unit",N=>{m.setUnit(N)})}if(e.navigationControl!==!1){const u=e.navigationControl===!0||e.navigationControl===void 0?"top-right":e.navigationControl;this.addControl(new Lr,u)}if(e.geolocateControl!==!1){const u=e.geolocateControl===!0||e.geolocateControl===void 0?"top-right":e.geolocateControl;this.addControl(new Pr({positionOptions:{enableHighAccuracy:!0,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!0,showAccuracyCircle:!0,showUserLocation:!0}),u)}if(e.terrainControl){const u=e.terrainControl===!0||e.terrainControl===void 0?"top-right":e.terrainControl;this.addControl(new fr,u)}if(e.fullscreenControl){const u=e.fullscreenControl===!0||e.fullscreenControl===void 0?"top-right":e.fullscreenControl;this.addControl(new Ur({}),u)}this.isReady=!0,this.fire("ready",{target:this})}));let l=!1,s=!1,h;this.once("ready",()=>{l=!0,s&&this.fire("loadWithTerrain",h)}),this.once("style.load",()=>{var c;const{minimap:u}=e;if(typeof u=="object"){const{zoom:m,center:N,style:f,language:F,apiKey:D,maptilerLogo:C,antialias:k,refreshExpiredTiles:B,maxBounds:U,scrollZoom:E,minZoom:I,maxZoom:L,boxZoom:T,locale:R,fadeDuration:M,crossSourceCollisions:_,clickTolerance:w,bounds:O,fitBoundsOptions:x,pixelRatio:z,validateStyle:H}=e;this.minimap=new Ie(u,{zoom:m,center:N,style:f,language:F,apiKey:D,container:"null",maptilerLogo:C,antialias:k,refreshExpiredTiles:B,maxBounds:U,scrollZoom:E,minZoom:I,maxZoom:L,boxZoom:T,locale:R,fadeDuration:M,crossSourceCollisions:_,clickTolerance:w,bounds:O,fitBoundsOptions:x,pixelRatio:z,validateStyle:H}),this.addControl(this.minimap,(c=u.position)!=null?c:"bottom-left")}else u===!0?(this.minimap=new Ie({},e),this.addControl(this.minimap,"bottom-left")):u!==void 0&&u!==!1&&(this.minimap=new Ie({},e),this.addControl(this.minimap,u))});const p=c=>{!c.terrain||(s=!0,h={type:"loadWithTerrain",target:this,terrain:c.terrain},this.off("terrain",p),l&&this.fire("loadWithTerrain",h))};this.on("terrain",p),e.terrain&&this.enableTerrain((o=e.terrainExaggeration)!=null?o:this.terrainExaggeration)}onLoadAsync(){return ee(this,null,function*(){return new Promise(e=>{if(this.loaded())return e(this);this.once("load",()=>{e(this)})})})}onReadyAsync(){return ee(this,null,function*(){return new Promise(e=>{if(this.isReady)return e(this);this.once("ready",()=>{e(this)})})})}onLoadWithTerrainAsync(){return ee(this,null,function*(){return new Promise(e=>{if(this.isReady&&this.terrain)return e(this);this.once("loadWithTerrain",()=>{e(this)})})})}setStyle(e,r){var a;return(a=this.minimap)==null||a.setStyle(e),this.forceLanguageUpdate=!0,this.once("idle",()=>{this.forceLanguageUpdate=!1}),super.setStyle(Xe(e),r)}addLayer(e,r){var a;return(a=this.minimap)==null||a.addLayer(e,r),super.addLayer(e,r)}moveLayer(e,r){var a;return(a=this.minimap)==null||a.moveLayer(e,r),super.moveLayer(e,r)}removeLayer(e){var r;return(r=this.minimap)==null||r.removeLayer(e),super.removeLayer(e)}setLayerZoomRange(e,r,a){var o;return(o=this.minimap)==null||o.setLayerZoomRange(e,r,a),super.setLayerZoomRange(e,r,a)}setFilter(e,r,a){var o;return(o=this.minimap)==null||o.setFilter(e,r,a),super.setFilter(e,r,a)}setPaintProperty(e,r,a,o){var n;return(n=this.minimap)==null||n.setPaintProperty(e,r,a,o),super.setPaintProperty(e,r,a,o)}setLayoutProperty(e,r,a,o){var n;return(n=this.minimap)==null||n.setLayoutProperty(e,r,a,o),super.setLayoutProperty(e,r,a,o)}setGlyphs(e,r){var a;return(a=this.minimap)==null||a.setGlyphs(e,r),super.setGlyphs(e,r)}getStyleLanguage(){return!this.style.stylesheet.metadata||typeof this.style.stylesheet.metadata!="object"?null:"maptiler:language"in this.style.stylesheet.metadata&&typeof this.style.stylesheet.metadata["maptiler:language"]=="string"?this.style.stylesheet.metadata["maptiler:language"]:null}setLanguage(e){var r,a;(a=(r=this.minimap)==null?void 0:r.map)==null||a.setLanguage(e),this.onStyleReady(()=>{this.setPrimaryLanguage(e)})}setPrimaryLanguage(e){const r=this.getStyleLanguage();if(!(e===A.STYLE&&(r===A.AUTO||r===A.VISITOR))&&(e!==A.STYLE&&(this.languageAlwaysBeenStyle=!1),this.languageAlwaysBeenStyle||this.primaryLanguage===e&&!this.forceLanguageUpdate))return;if(!Ve(e)){console.warn(`The language "${e}" is not supported.`);return}if(this.primaryLanguage===A.STYLE_LOCK){console.warn("The language cannot be changed because this map has been instantiated with the STYLE_LOCK language flag.");return}this.primaryLanguage=e;let a=e;if(e===A.STYLE){if(!r){console.warn("The style has no default languages.");return}if(!Ve(r)){console.warn("The language defined in the style is not valid.");return}a=r}let o=A.LOCAL,n=`{${o}}`;a==A.VISITOR?(o=Ge(),n=["case",["all",["has",o],["has",A.LOCAL]],["case",["==",["get",o],["get",A.LOCAL]],["get",A.LOCAL],["format",["get",o],{"font-scale":.8},`
`,["get",A.LOCAL],{"font-scale":1.1}]],["get",A.LOCAL]]):a==A.VISITOR_ENGLISH?(o=A.ENGLISH,n=["case",["all",["has",o],["has",A.LOCAL]],["case",["==",["get",o],["get",A.LOCAL]],["get",A.LOCAL],["format",["get",o],{"font-scale":.8},`
`,["get",A.LOCAL],{"font-scale":1.1}]],["get",A.LOCAL]]):a===A.AUTO?(o=Ge(),n=["case",["has",o],["get",o],["get",A.LOCAL]]):a===A.LOCAL?(o=A.LOCAL,n=`{${o}}`):(o=a,n=["case",["has",o],["get",o],["get",A.LOCAL]]);const{layers:i}=this.getStyle();for(const{id:l,layout:s}of i){if(!s||!("text-field"in s))continue;const h=this.getLayoutProperty(l,"text-field");typeof h=="string"&&(h.toLowerCase().includes("ref")||h.toLowerCase().includes("housenumber"))||this.setLayoutProperty(l,"text-field",n)}}getPrimaryLanguage(){return this.primaryLanguage}getTerrainExaggeration(){return this.terrainExaggeration}hasTerrain(){return this.isTerrainEnabled}growTerrain(e,r=1e3){if(!this.terrain)return;const a=performance.now(),o=this.terrain.exaggeration,n=e-o,i=()=>{if(!this.terrain||this.terrainFlattening)return;const l=(performance.now()-a)/r;if(l<.99){const s=1-Math.pow(1-l,4),h=o+s*n;this.terrain.exaggeration=h,requestAnimationFrame(i)}else this.terrainGrowing=!1,this.terrainFlattening=!1,this.terrain.exaggeration=e;this.triggerRepaint()};this.terrainGrowing=!0,this.terrainFlattening=!1,requestAnimationFrame(i)}enableTerrain(e=this.terrainExaggeration){if(e<0){console.warn("Terrain exaggeration cannot be negative.");return}const r=o=>ee(this,null,function*(){!this.terrain||o.type!=="data"||o.dataType!=="source"||!("source"in o)||o.sourceId!=="maptiler-terrain"||o.source.type!=="raster-dem"||!o.isSourceLoaded||(this.off("data",r),this.growTerrain(e))}),a=()=>{this.isTerrainEnabled=!0,this.terrainExaggeration=e,this.on("data",r),this.addSource(J.terrainSourceId,{type:"raster-dem",url:J.terrainSourceURL}),this.setTerrain({source:J.terrainSourceId,exaggeration:0})};if(this.getTerrain()){this.isTerrainEnabled=!0,this.growTerrain(e);return}this.loaded()||this.isTerrainEnabled?a():this.once("load",()=>{this.getTerrain()&&this.getSource(J.terrainSourceId)||a()})}disableTerrain(){if(!this.terrain)return;this.isTerrainEnabled=!1;const e=1*1e3,r=performance.now(),a=this.terrain.exaggeration,o=()=>{if(!this.terrain||this.terrainGrowing)return;const n=(performance.now()-r)/e;if(n<.99){const i=Math.pow(1-n,4),l=a*i;this.terrain.exaggeration=l,requestAnimationFrame(o)}else this.terrain.exaggeration=0,this.terrainGrowing=!1,this.terrainFlattening=!1,this.setTerrain(),this.getSource(J.terrainSourceId)&&this.removeSource(J.terrainSourceId);this.triggerRepaint()};this.terrainGrowing=!1,this.terrainFlattening=!0,requestAnimationFrame(o)}setTerrainExaggeration(e,r=!0){!r&&this.terrain?(this.terrainExaggeration=e,this.terrain.exaggeration=e,this.triggerRepaint()):this.enableTerrain(e)}onStyleReady(e){this.isStyleLoaded()?e():this.once("styledata",()=>{e()})}fitToIpBounds(){return ee(this,null,function*(){const e=yield He.info();this.fitBounds(e.country_bounds,{duration:0,padding:100})})}centerOnIpPoint(e){return ee(this,null,function*(){var r,a;const o=yield He.info();this.jumpTo({center:[(r=o==null?void 0:o.longitude)!=null?r:0,(a=o==null?void 0:o.latitude)!=null?a:0],zoom:e||11})})}getCameraHash(){const e=new Float32Array(5),r=this.getCenter();return e[0]=r.lng,e[1]=r.lat,e[2]=this.getZoom(),e[3]=this.getPitch(),e[4]=this.getBearing(),Ht.fromUint8Array(new Uint8Array(e.buffer))}getSdkConfig(){return Z}getMaptilerSessionId(){return Rt}setTransformRequest(e){return super.setTransformRequest(Je(e)),this}loadImageAsync(e){return ee(this,null,function*(){return new Promise((r,a)=>{this.loadImage(e,(o,n)=>{if(o){a(o);return}r(n)})})})}}class Na extends y.Marker{addTo(e){return super.addTo(e)}}class Ua extends y.Popup{addTo(e){return super.addTo(e)}}class xa extends y.Style{constructor(e,r={}){super(e,r)}}class Da extends y.CanvasSource{onAdd(e){super.onAdd(e)}}class Ma extends y.GeoJSONSource{onAdd(e){super.onAdd(e)}}class za extends y.ImageSource{onAdd(e){super.onAdd(e)}}class Fa extends y.RasterTileSource{onAdd(e){super.onAdd(e)}}class Ba extends y.RasterDEMTileSource{onAdd(e){super.onAdd(e)}}class ka extends y.VectorTileSource{onAdd(e){super.onAdd(e)}}class $a extends y.VideoSource{onAdd(e){super.onAdd(e)}}class Ha extends y.TerrainControl{onAdd(e){return super.onAdd(e)}}var Zr=Object.defineProperty,nt=Object.getOwnPropertySymbols,Yr=Object.prototype.hasOwnProperty,qr=Object.prototype.propertyIsEnumerable,it=(t,e,r)=>e in t?Zr(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ue=(t,e)=>{for(var r in e||(e={}))Yr.call(e,r)&&it(t,r,e[r]);if(nt)for(var r of nt(e))qr.call(e,r)&&it(t,r,e[r]);return t};function Me(t){if(typeof DOMParser<"u"){const e=new DOMParser().parseFromString(t,"application/xml");if(e.querySelector("parsererror"))throw new Error("The provided string is not valid XML");return e}else throw new Error("No XML parser found")}function Nt(t,e){if(!t.hasChildNodes())return!1;for(const r of Array.from(t.childNodes)){const a=r.nodeName;if(typeof a=="string"&&a.trim().toLowerCase()===e.toLowerCase())return!0}return!1}function lt(t){if(typeof XMLSerializer<"u")return new XMLSerializer().serializeToString(t);throw new Error("No XML serializer found")}function Ut(t){if(typeof t=="string"&&(t=Me(t)),!Nt(t,"gpx"))throw new Error("The XML document is not valid GPX");const e=$(t,"trk"),r=$(t,"rte"),a=$(t,"wpt"),o={type:"FeatureCollection",features:[]};for(const n of Array.from(e)){const i=ea(n);i&&o.features.push(i)}for(const n of Array.from(r)){const i=ta(n);i&&o.features.push(i)}for(const n of Array.from(a))o.features.push(ra(n));return o}function xt(t,e){var r;if(typeof t=="string"&&(t=Me(t)),!Nt(t,"kml"))throw new Error("The XML document is not valid KML");const a={type:"FeatureCollection",features:[]},o={},n={},i={},l=$(t,"Placemark"),s=$(t,"Style"),h=$(t,"StyleMap");for(const p of Array.from(s)){const c=ct(e!==void 0?e(p):lt(p)).toString(16);o["#"+le(p,"id")]=c,n[c]=p}for(const p of Array.from(h)){o["#"+le(p,"id")]=ct(e!==void 0?e(p):lt(p)).toString(16);const c=$(p,"Pair"),u={};for(const m of Array.from(c))u[(r=b(g(m,"key")))!=null?r:""]=b(g(m,"styleUrl"));i["#"+le(p,"id")]=u}for(const p of Array.from(l))a.features=a.features.concat(Qr(p,o,n,i));return a}function st(t){if(t===null)return["#000000",1];let e="",r=1;return t.substring(0,1)==="#"&&(t=t.substring(1)),(t.length===6||t.length===3)&&(e=t),t.length===8&&(r=parseInt(t.substring(0,2),16)/255,e="#"+t.substring(6,8)+t.substring(4,6)+t.substring(2,4)),[e!=null?e:"#000000",r!=null?r:1]}function Jr(t){return zt(t.split(" "))}function Xr(t){var e;let r=$(t,"coord");const a=[],o=[];r.length===0&&(r=$(t,"gx:coord"));for(const i of Array.from(r))a.push(Jr((e=b(i))!=null?e:""));const n=$(t,"when");for(const i of Array.from(n))o.push(b(i));return{coords:a,times:o}}function Le(t){var e,r,a;const o=["Polygon","LineString","Point","Track","gx:Track"];let n,i,l,s,h;const p=[],c=[];if(g(t,"MultiGeometry")!==null)return Le(g(t,"MultiGeometry"));if(g(t,"MultiTrack")!==null)return Le(g(t,"MultiTrack"));if(g(t,"gx:MultiTrack")!==null)return Le(g(t,"gx:MultiTrack"));for(l=0;l<o.length;l++)if(i=$(t,o[l]),i){for(s=0;s<i.length;s++)if(n=i[s],o[l]==="Point")p.push({type:"Point",coordinates:Ft((e=b(g(n,"coordinates")))!=null?e:"")});else if(o[l]==="LineString")p.push({type:"LineString",coordinates:pt((r=b(g(n,"coordinates")))!=null?r:"")});else if(o[l]==="Polygon"){const u=$(n,"LinearRing"),m=[];for(h=0;h<u.length;h++)m.push(pt((a=b(g(u[h],"coordinates")))!=null?a:""));p.push({type:"Polygon",coordinates:m})}else if(o[l]==="Track"||o[l]==="gx:Track"){const u=Xr(n);p.push({type:"LineString",coordinates:u.coords}),u.times.length&&c.push(u.times)}}return{geoms:p,coordTimes:c}}function Qr(t,e,r,a){var o,n,i,l,s,h,p,c,u,m;const N=Le(t),f={},F=b(g(t,"name")),D=b(g(t,"address")),C=b(g(t,"description")),k=g(t,"TimeSpan"),B=g(t,"TimeStamp"),U=g(t,"ExtendedData"),E=g(t,"visibility");let I,L=b(g(t,"styleUrl")),T=g(t,"LineStyle"),R=g(t,"PolyStyle");if(!N.geoms.length)return[];if(F&&(f.name=F),D&&(f.address=D),L){L[0]!=="#"&&(L="#"+L),f.styleUrl=L,e[L]&&(f.styleHash=e[L]),a[L]&&(f.styleMapHash=a[L],f.styleHash=e[(o=a[L].normal)!=null?o:""]);const _=r[(n=f.styleHash)!=null?n:""];if(_){T||(T=g(_,"LineStyle")),R||(R=g(_,"PolyStyle"));const w=g(_,"IconStyle");if(w){const O=g(w,"Icon");if(O){const x=b(g(O,"href"));x&&(f.icon=x)}}}}if(C&&(f.description=C),k){const _=b(g(k,"begin")),w=b(g(k,"end"));_&&w&&(f.timespan={begin:_,end:w})}if(B!==null&&(f.timestamp=(i=b(g(B,"when")))!=null?i:new Date().toISOString()),T!==null){const _=st(b(g(T,"color"))),w=_[0],O=_[1],x=parseFloat((l=b(g(T,"width")))!=null?l:"");w&&(f.stroke=w),isNaN(O)||(f["stroke-opacity"]=O),isNaN(x)||(f["stroke-width"]=x)}if(R){const _=st(b(g(R,"color"))),w=_[0],O=_[1],x=b(g(R,"fill")),z=b(g(R,"outline"));w&&(f.fill=w),isNaN(O)||(f["fill-opacity"]=O),x&&(f["fill-opacity"]=x==="1"?f["fill-opacity"]||1:0),z&&(f["stroke-opacity"]=z==="1"?f["stroke-opacity"]||1:0)}if(U){const _=$(U,"Data"),w=$(U,"SimpleData");for(I=0;I<_.length;I++)f[(s=_[I].getAttribute("name"))!=null?s:""]=(h=b(g(_[I],"value")))!=null?h:"";for(I=0;I<w.length;I++)f[(p=w[I].getAttribute("name"))!=null?p:""]=(c=b(w[I]))!=null?c:""}E!==null&&(f.visibility=(u=b(E))!=null?u:""),N.coordTimes.length!==0&&(f.coordTimes=N.coordTimes.length===1?N.coordTimes[0]:N.coordTimes);const M={type:"Feature",geometry:N.geoms.length===1?N.geoms[0]:{type:"GeometryCollection",geometries:N.geoms},properties:f};return le(t,"id")&&(M.id=(m=le(t,"id"))!=null?m:void 0),[M]}function Dt(t,e){const r=$(t,e),a=[],o=[];let n=[];const i=r.length;if(!(i<2)){for(let l=0;l<i;l++){const s=Bt(r[l]);a.push(s.coordinates),s.time&&o.push(s.time),(s.heartRate||n.length)&&(n.length===0&&(n=new Array(l).fill(null)),n.push(s.heartRate))}return{line:a,times:o,heartRates:n}}}function ea(t){const e=$(t,"trkseg"),r=[],a=[],o=[];let n;for(let l=0;l<e.length;l++)if(n=Dt(e[l],"trkpt"),n!==void 0&&(n.line&&r.push(n.line),n.times&&n.times.length&&a.push(n.times),o.length||n.heartRates&&n.heartRates.length)){if(!o.length)for(let s=0;s<l;s++)o.push(new Array(r[s].length).fill(null));n.heartRates&&n.heartRates.length?o.push(n.heartRates):o.push(new Array(n.line.length).fill(null))}if(r.length===0)return;const i=ue(ue({},ze(t)),Mt(g(t,"extensions")));return a.length!==0&&(i.coordTimes=r.length===1?a[0]:a),o.length!==0&&(i.heartRates=r.length===1?o[0]:o),r.length===1?{type:"Feature",properties:i,geometry:{type:"LineString",coordinates:r[0]}}:{type:"Feature",properties:i,geometry:{type:"MultiLineString",coordinates:r}}}function ta(t){const e=Dt(t,"rtept");return e===void 0?void 0:{type:"Feature",properties:ue(ue({},ze(t)),Mt(g(t,"extensions"))),geometry:{type:"LineString",coordinates:e.line}}}function ra(t){return{type:"Feature",properties:ue(ue({},ze(t)),xe(t,["sym"])),geometry:{type:"Point",coordinates:Bt(t).coordinates}}}function Mt(t){var e,r;const a={};if(t){const o=g(t,"line");if(o){const n=b(g(o,"color")),i=parseFloat((e=b(g(o,"opacity")))!=null?e:"0"),l=parseFloat((r=b(g(o,"width")))!=null?r:"0");n&&(a.stroke=n),isNaN(i)||(a["stroke-opacity"]=i),isNaN(l)||(a["stroke-width"]=l*96/25.4)}}return a}function ze(t){const e=xe(t,["name","cmt","desc","type","time","keywords"]),r=$(t,"link");if(r.length!==0){e.links=[];for(const a of Array.from(r)){const o=ue({href:le(a,"href")},xe(a,["text","type"]));e.links.push(o)}}return e}function ct(t){let e=0;if(!t||!t.length)return e;for(let r=0;r<t.length;r++)e=(e<<5)-e+t.charCodeAt(r)|0;return e}function $(t,e){return t.getElementsByTagName(e)}function le(t,e){return t.getAttribute(e)}function ut(t,e){var r;return parseFloat((r=le(t,e))!=null?r:"0")}function g(t,e){const r=$(t,e);return r.length?r[0]:null}function aa(t){return t.normalize&&t.normalize(),t}function zt(t){return t.map(parseFloat).map(e=>isNaN(e)?null:e)}function b(t){return t&&aa(t),t&&t.textContent}function xe(t,e){var r;const a={};let o,n;for(n=0;n<e.length;n++)o=g(t,e[n]),o&&(a[e[n]]=(r=b(o))!=null?r:"");return a}function Ft(t){return zt(t.replace(/\s*/g,"").split(","))}function pt(t){const e=t.replace(/^\s*|\s*$/g,"").split(/\s+/),r=[];for(const a of e)r.push(Ft(a));return r}function Bt(t){var e,r;const a=[ut(t,"lon"),ut(t,"lat")],o=g(t,"ele"),n=g(t,"gpxtpx:hr")||g(t,"hr"),i=g(t,"time");let l;return o&&(l=parseFloat((e=b(o))!=null?e:"0"),isNaN(l)||a.push(l)),{coordinates:a,time:i?b(i):null,heartRate:n!==null?parseFloat((r=b(n))!=null?r:"0"):null}}function oa(t){try{typeof t=="string"&&(t=Me(t))}catch(e){return null}try{return Ut(t)}catch(e){}try{return xt(t)}catch(e){}return null}var na=Object.defineProperty,ia=(t,e,r)=>e in t?na(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ht=(t,e,r)=>(ia(t,typeof e!="symbol"?e+"":e,r),r);function ve(t){const e=t.toString(16);return e.length==1?"0"+e:e}function la(t){return"#"+ve(t[0])+ve(t[1])+ve(t[2])+(t.length===4?ve(t[3]):"")}class d extends Array{constructor(e={}){super(),ht(this,"min",0),ht(this,"max",1),"min"in e&&(this.min=e.min),"max"in e&&(this.max=e.max),"stops"in e&&this.setStops(e.stops,{clone:!1})}static fromArrayDefinition(e){return new d({stops:e.map(r=>({value:r[0],color:r[1]}))})}setStops(e,r={clone:!0}){const a=r.clone?this.clone():this;a.length=0;let o=1/0,n=-1/0;for(let i=0;i<e.length;i+=1)o=Math.min(o,e[i].value),n=Math.max(n,e[i].value),a.push({value:e[i].value,color:e[i].color.slice()});return a.sort((i,l)=>i.value<l.value?-1:1),this.min=o,this.max=n,a}scale(e,r,a={clone:!0}){const o=a.clone,n=this[0].value,l=this.at(-1).value-n,s=r-e,h=[];for(let p=0;p<this.length;p+=1){const m=(this[p].value-n)/l*s+e;o?h.push({value:m,color:this[p].color.slice()}):this[p].value=m}return o?new d({stops:h}):this}at(e){return e<0?this[this.length+e]:this[e]}clone(){return new d({stops:this.getRawColorStops()})}getRawColorStops(){const e=[];for(let r=0;r<this.length;r+=1)e.push({value:this[r].value,color:this[r].color});return e}reverse(e={clone:!0}){const r=e.clone?this.clone():this;for(let a=0;a<~~(r.length/2);a+=1){const o=r[a].color;r[a].color=r.at(-(a+1)).color,r.at(-(a+1)).color=o}return r}getBounds(){return{min:this.min,max:this.max}}getColor(e,r={smooth:!0}){if(e<=this[0].value)return this[0].color;if(e>=this.at(-1).value)return this.at(-1).color;for(let a=0;a<this.length-1;a+=1){if(e>this[a+1].value)continue;const o=this[a].color;if(!r.smooth)return o.slice();const n=this[a].value,i=this[a+1].value,l=this[a+1].color,s=(i-e)/(i-n);return o.map((h,p)=>Math.round(h*s+l[p]*(1-s)))}return[0,0,0]}getColorHex(e,r={smooth:!0,withAlpha:!1}){return la(this.getColor(e,r))}getColorRelative(e,r={smooth:!0}){const a=this.getBounds();return this.getColor(a.min+e*(a.max-a.min),r)}getCanvasStrip(e={horizontal:!0,size:512,smooth:!0}){const r=document.createElement("canvas");r.width=e.horizontal?e.size:1,r.height=e.horizontal?1:e.size;const a=r.getContext("2d");if(!a)throw new Error("Canvs context is missing");const o=a.getImageData(0,0,r.width,r.height),n=o.data,i=e.size,l=this[0].value,p=(this.at(-1).value-l)/i;for(let c=0;c<i;c+=1){const u=this.getColor(l+c*p,{smooth:e.smooth});n[c*4]=u[0],n[c*4+1]=u[1],n[c*4+2]=u[2],n[c*4+3]=u.length>3?u[3]:255}return a.putImageData(o,0,0),r}resample(e,r=15){const a=this.getBounds(),o=this.scale(0,1),n=1/(r-1);let i;if(e==="ease-in-square")i=Array.from({length:r},(h,p)=>{const c=p*n,u=Math.pow(c,2),m=o.getColor(u);return{value:c,color:m}});else if(e==="ease-out-square")i=Array.from({length:r},(h,p)=>{const c=p*n,u=1-Math.pow(1-c,2),m=o.getColor(u);return{value:c,color:m}});else if(e==="ease-out-sqrt")i=Array.from({length:r},(h,p)=>{const c=p*n,u=Math.pow(c,.5),m=o.getColor(u);return{value:c,color:m}});else if(e==="ease-in-sqrt")i=Array.from({length:r},(h,p)=>{const c=p*n,u=1-Math.pow(1-c,.5),m=o.getColor(u);return{value:c,color:m}});else if(e==="ease-out-exp")i=Array.from({length:r},(h,p)=>{const c=p*n,u=1-Math.pow(2,-10*c),m=o.getColor(u);return{value:c,color:m}});else if(e==="ease-in-exp")i=Array.from({length:r},(h,p)=>{const c=p*n,u=Math.pow(2,10*c-10),m=o.getColor(u);return{value:c,color:m}});else throw new Error("Invalid ressampling method.");return new d({stops:i}).scale(a.min,a.max)}transparentStart(){const e=this.getRawColorStops();return e.unshift({value:e[0].value,color:e[0].color.slice()}),e[1].value+=.001,e.forEach(r=>{r.color.length===3&&r.color.push(255)}),e[0].color[3]=0,new d({stops:e})}hasTransparentStart(){return this[0].color.length===4&&this[0].color[3]===0}}const kt={NULL:new d({stops:[{value:0,color:[0,0,0,0]},{value:1,color:[0,0,0,0]}]}),GRAY:new d({stops:[{value:0,color:[0,0,0]},{value:1,color:[255,255,255]}]}),JET:new d({stops:[{value:0,color:[0,0,131]},{value:.125,color:[0,60,170]},{value:.375,color:[5,255,255]},{value:.625,color:[255,255,0]},{value:.875,color:[250,0,0]},{value:1,color:[128,0,0]}]}),HSV:new d({stops:[{value:0,color:[255,0,0]},{value:.169,color:[253,255,2]},{value:.173,color:[247,255,2]},{value:.337,color:[0,252,4]},{value:.341,color:[0,252,10]},{value:.506,color:[1,249,255]},{value:.671,color:[2,0,253]},{value:.675,color:[8,0,253]},{value:.839,color:[255,0,251]},{value:.843,color:[255,0,245]},{value:1,color:[255,0,6]}]}),HOT:new d({stops:[{value:0,color:[0,0,0]},{value:.3,color:[230,0,0]},{value:.6,color:[255,210,0]},{value:1,color:[255,255,255]}]}),SPRING:new d({stops:[{value:0,color:[255,0,255]},{value:1,color:[255,255,0]}]}),SUMMER:new d({stops:[{value:0,color:[0,128,102]},{value:1,color:[255,255,102]}]}),AUTOMN:new d({stops:[{value:0,color:[255,0,0]},{value:1,color:[255,255,0]}]}),WINTER:new d({stops:[{value:0,color:[0,0,255]},{value:1,color:[0,255,128]}]}),BONE:new d({stops:[{value:0,color:[0,0,0]},{value:.376,color:[84,84,116]},{value:.753,color:[169,200,200]},{value:1,color:[255,255,255]}]}),COPPER:new d({stops:[{value:0,color:[0,0,0]},{value:.804,color:[255,160,102]},{value:1,color:[255,199,127]}]}),GREYS:new d({stops:[{value:0,color:[0,0,0]},{value:1,color:[255,255,255]}]}),YIGNBU:new d({stops:[{value:0,color:[8,29,88]},{value:.125,color:[37,52,148]},{value:.25,color:[34,94,168]},{value:.375,color:[29,145,192]},{value:.5,color:[65,182,196]},{value:.625,color:[127,205,187]},{value:.75,color:[199,233,180]},{value:.875,color:[237,248,217]},{value:1,color:[255,255,217]}]}),GREENS:new d({stops:[{value:0,color:[0,68,27]},{value:.125,color:[0,109,44]},{value:.25,color:[35,139,69]},{value:.375,color:[65,171,93]},{value:.5,color:[116,196,118]},{value:.625,color:[161,217,155]},{value:.75,color:[199,233,192]},{value:.875,color:[229,245,224]},{value:1,color:[247,252,245]}]}),YIORRD:new d({stops:[{value:0,color:[128,0,38]},{value:.125,color:[189,0,38]},{value:.25,color:[227,26,28]},{value:.375,color:[252,78,42]},{value:.5,color:[253,141,60]},{value:.625,color:[254,178,76]},{value:.75,color:[254,217,118]},{value:.875,color:[255,237,160]},{value:1,color:[255,255,204]}]}),BLUERED:new d({stops:[{value:0,color:[0,0,255]},{value:1,color:[255,0,0]}]}),RDBU:new d({stops:[{value:0,color:[5,10,172]},{value:.35,color:[106,137,247]},{value:.5,color:[190,190,190]},{value:.6,color:[220,170,132]},{value:.7,color:[230,145,90]},{value:1,color:[178,10,28]}]}),PICNIC:new d({stops:[{value:0,color:[0,0,255]},{value:.1,color:[51,153,255]},{value:.2,color:[102,204,255]},{value:.3,color:[153,204,255]},{value:.4,color:[204,204,255]},{value:.5,color:[255,255,255]},{value:.6,color:[255,204,255]},{value:.7,color:[255,153,255]},{value:.8,color:[255,102,204]},{value:.9,color:[255,102,102]},{value:1,color:[255,0,0]}]}),RAINBOW:new d({stops:[{value:0,color:[150,0,90]},{value:.125,color:[0,0,200]},{value:.25,color:[0,25,255]},{value:.375,color:[0,152,255]},{value:.5,color:[44,255,150]},{value:.625,color:[151,255,0]},{value:.75,color:[255,234,0]},{value:.875,color:[255,111,0]},{value:1,color:[255,0,0]}]}),PORTLAND:new d({stops:[{value:0,color:[12,51,131]},{value:.25,color:[10,136,186]},{value:.5,color:[242,211,56]},{value:.75,color:[242,143,56]},{value:1,color:[217,30,30]}]}),BLACKBODY:new d({stops:[{value:0,color:[0,0,0]},{value:.2,color:[230,0,0]},{value:.4,color:[230,210,0]},{value:.7,color:[255,255,255]},{value:1,color:[160,200,255]}]}),EARTH:new d({stops:[{value:0,color:[0,0,130]},{value:.1,color:[0,180,180]},{value:.2,color:[40,210,40]},{value:.4,color:[230,230,50]},{value:.6,color:[120,70,20]},{value:1,color:[255,255,255]}]}),ELECTRIC:new d({stops:[{value:0,color:[0,0,0]},{value:.15,color:[30,0,100]},{value:.4,color:[120,0,100]},{value:.6,color:[160,90,0]},{value:.8,color:[230,200,0]},{value:1,color:[255,250,220]}]}),VIRIDIS:new d({stops:[{value:0,color:[68,1,84]},{value:.13,color:[71,44,122]},{value:.25,color:[59,81,139]},{value:.38,color:[44,113,142]},{value:.5,color:[33,144,141]},{value:.63,color:[39,173,129]},{value:.75,color:[92,200,99]},{value:.88,color:[170,220,50]},{value:1,color:[253,231,37]}]}),INFERNO:new d({stops:[{value:0,color:[0,0,4]},{value:.13,color:[31,12,72]},{value:.25,color:[85,15,109]},{value:.38,color:[136,34,106]},{value:.5,color:[186,54,85]},{value:.63,color:[227,89,51]},{value:.75,color:[249,140,10]},{value:.88,color:[249,201,50]},{value:1,color:[252,255,164]}]}),MAGMA:new d({stops:[{value:0,color:[0,0,4]},{value:.13,color:[28,16,68]},{value:.25,color:[79,18,123]},{value:.38,color:[129,37,129]},{value:.5,color:[181,54,122]},{value:.63,color:[229,80,100]},{value:.75,color:[251,135,97]},{value:.88,color:[254,194,135]},{value:1,color:[252,253,191]}]}),PLASMA:new d({stops:[{value:0,color:[13,8,135]},{value:.13,color:[75,3,161]},{value:.25,color:[125,3,168]},{value:.38,color:[168,34,150]},{value:.5,color:[203,70,121]},{value:.63,color:[229,107,93]},{value:.75,color:[248,148,65]},{value:.88,color:[253,195,40]},{value:1,color:[240,249,33]}]}),WARM:new d({stops:[{value:0,color:[125,0,179]},{value:.13,color:[172,0,187]},{value:.25,color:[219,0,170]},{value:.38,color:[255,0,130]},{value:.5,color:[255,63,74]},{value:.63,color:[255,123,0]},{value:.75,color:[234,176,0]},{value:.88,color:[190,228,0]},{value:1,color:[147,255,0]}]}),COOL:new d({stops:[{value:0,color:[125,0,179]},{value:.13,color:[116,0,218]},{value:.25,color:[98,74,237]},{value:.38,color:[68,146,231]},{value:.5,color:[0,204,197]},{value:.63,color:[0,247,146]},{value:.75,color:[0,255,88]},{value:.88,color:[40,255,8]},{value:1,color:[147,255,0]}]}),RAINBOW_SOFT:new d({stops:[{value:0,color:[125,0,179]},{value:.1,color:[199,0,180]},{value:.2,color:[255,0,121]},{value:.3,color:[255,108,0]},{value:.4,color:[222,194,0]},{value:.5,color:[150,255,0]},{value:.6,color:[0,255,55]},{value:.7,color:[0,246,150]},{value:.8,color:[50,167,222]},{value:.9,color:[103,51,235]},{value:1,color:[124,0,186]}]}),BATHYMETRY:new d({stops:[{value:0,color:[40,26,44]},{value:.13,color:[59,49,90]},{value:.25,color:[64,76,139]},{value:.38,color:[63,110,151]},{value:.5,color:[72,142,158]},{value:.63,color:[85,174,163]},{value:.75,color:[120,206,163]},{value:.88,color:[187,230,172]},{value:1,color:[253,254,204]}]}),CDOM:new d({stops:[{value:0,color:[47,15,62]},{value:.13,color:[87,23,86]},{value:.25,color:[130,28,99]},{value:.38,color:[171,41,96]},{value:.5,color:[206,67,86]},{value:.63,color:[230,106,84]},{value:.75,color:[242,149,103]},{value:.88,color:[249,193,135]},{value:1,color:[254,237,176]}]}),CHLOROPHYLL:new d({stops:[{value:0,color:[18,36,20]},{value:.13,color:[25,63,41]},{value:.25,color:[24,91,59]},{value:.38,color:[13,119,72]},{value:.5,color:[18,148,80]},{value:.63,color:[80,173,89]},{value:.75,color:[132,196,122]},{value:.88,color:[175,221,162]},{value:1,color:[215,249,208]}]}),DENSITY:new d({stops:[{value:0,color:[54,14,36]},{value:.13,color:[89,23,80]},{value:.25,color:[110,45,132]},{value:.38,color:[120,77,178]},{value:.5,color:[120,113,213]},{value:.63,color:[115,151,228]},{value:.75,color:[134,185,227]},{value:.88,color:[177,214,227]},{value:1,color:[230,241,241]}]}),FREESURFACE_BLUE:new d({stops:[{value:0,color:[30,4,110]},{value:.13,color:[47,14,176]},{value:.25,color:[41,45,236]},{value:.38,color:[25,99,212]},{value:.5,color:[68,131,200]},{value:.63,color:[114,156,197]},{value:.75,color:[157,181,203]},{value:.88,color:[200,208,216]},{value:1,color:[241,237,236]}]}),FREESURFACE_RED:new d({stops:[{value:0,color:[60,9,18]},{value:.13,color:[100,17,27]},{value:.25,color:[142,20,29]},{value:.38,color:[177,43,27]},{value:.5,color:[192,87,63]},{value:.63,color:[205,125,105]},{value:.75,color:[216,162,148]},{value:.88,color:[227,199,193]},{value:1,color:[241,237,236]}]}),OXYGEN:new d({stops:[{value:0,color:[64,5,5]},{value:.13,color:[106,6,15]},{value:.25,color:[144,26,7]},{value:.38,color:[168,64,3]},{value:.5,color:[188,100,4]},{value:.63,color:[206,136,11]},{value:.75,color:[220,174,25]},{value:.88,color:[231,215,44]},{value:1,color:[248,254,105]}]}),PAR:new d({stops:[{value:0,color:[51,20,24]},{value:.13,color:[90,32,35]},{value:.25,color:[129,44,34]},{value:.38,color:[159,68,25]},{value:.5,color:[182,99,19]},{value:.63,color:[199,134,22]},{value:.75,color:[212,171,35]},{value:.88,color:[221,210,54]},{value:1,color:[225,253,75]}]}),PHASE:new d({stops:[{value:0,color:[145,105,18]},{value:.13,color:[184,71,38]},{value:.25,color:[186,58,115]},{value:.38,color:[160,71,185]},{value:.5,color:[110,97,218]},{value:.63,color:[50,123,164]},{value:.75,color:[31,131,110]},{value:.88,color:[77,129,34]},{value:1,color:[145,105,18]}]}),SALINITY:new d({stops:[{value:0,color:[42,24,108]},{value:.13,color:[33,50,162]},{value:.25,color:[15,90,145]},{value:.38,color:[40,118,137]},{value:.5,color:[59,146,135]},{value:.63,color:[79,175,126]},{value:.75,color:[120,203,104]},{value:.88,color:[193,221,100]},{value:1,color:[253,239,154]}]}),TEMPERATURE:new d({stops:[{value:0,color:[4,35,51]},{value:.13,color:[23,51,122]},{value:.25,color:[85,59,157]},{value:.38,color:[129,79,143]},{value:.5,color:[175,95,130]},{value:.63,color:[222,112,101]},{value:.75,color:[249,146,66]},{value:.88,color:[249,196,65]},{value:1,color:[232,250,91]}]}),TURBIDITY:new d({stops:[{value:0,color:[34,31,27]},{value:.13,color:[65,50,41]},{value:.25,color:[98,69,52]},{value:.38,color:[131,89,57]},{value:.5,color:[161,112,59]},{value:.63,color:[185,140,66]},{value:.75,color:[202,174,88]},{value:.88,color:[216,209,126]},{value:1,color:[233,246,171]}]}),VELOCITY_BLUE:new d({stops:[{value:0,color:[17,32,64]},{value:.13,color:[35,52,116]},{value:.25,color:[29,81,156]},{value:.38,color:[31,113,162]},{value:.5,color:[50,144,169]},{value:.63,color:[87,173,176]},{value:.75,color:[149,196,189]},{value:.88,color:[203,221,211]},{value:1,color:[254,251,230]}]}),VELOCITY_GREEN:new d({stops:[{value:0,color:[23,35,19]},{value:.13,color:[24,64,38]},{value:.25,color:[11,95,45]},{value:.38,color:[39,123,35]},{value:.5,color:[95,146,12]},{value:.63,color:[152,165,18]},{value:.75,color:[201,186,69]},{value:.88,color:[233,216,137]},{value:1,color:[255,253,205]}]}),CUBEHELIX:new d({stops:[{value:0,color:[0,0,0]},{value:.07,color:[22,5,59]},{value:.13,color:[60,4,105]},{value:.2,color:[109,1,135]},{value:.27,color:[161,0,147]},{value:.33,color:[210,2,142]},{value:.4,color:[251,11,123]},{value:.47,color:[255,29,97]},{value:.53,color:[255,54,69]},{value:.6,color:[255,85,46]},{value:.67,color:[255,120,34]},{value:.73,color:[255,157,37]},{value:.8,color:[241,191,57]},{value:.87,color:[224,220,93]},{value:.93,color:[218,241,142]},{value:1,color:[227,253,198]}]}),CIVIDIS:new d({stops:[{value:0,color:[0,32,77,255]},{value:.125,color:[5,54,110,255]},{value:.25,color:[65,77,108,255]},{value:.375,color:[97,100,111,255]},{value:.5,color:[125,124,121,255]},{value:.625,color:[156,149,120,255]},{value:.75,color:[190,175,111,255]},{value:.875,color:[225,204,94,255]},{value:1,color:[255,235,70,255]}]}),TURBO:new d({stops:[{value:0,color:[48,18,59,255]},{value:.125,color:[70,107,227,255]},{value:.25,color:[40,187,236,255]},{value:.375,color:[49,242,153,255]},{value:.5,color:[162,252,60,255]},{value:.625,color:[237,208,58,255]},{value:.75,color:[251,128,34,255]},{value:.875,color:[210,49,5,255]},{value:1,color:[122,4,3,255]}]}),ROCKET:new d({stops:[{value:0,color:[250,235,221,0]},{value:.133,color:[250,235,221,255]},{value:.266,color:[246,170,130,255]},{value:.4,color:[240,96,67,255]},{value:.533,color:[203,27,79,255]},{value:.666,color:[132,30,90,255]},{value:.8,color:[63,27,68,255]},{value:1,color:[3,5,26,255]}]}),MAKO:new d({stops:[{value:0,color:[11,4,5,255]},{value:.125,color:[43,28,53,255]},{value:.25,color:[62,53,107,255]},{value:.375,color:[59,86,152,255]},{value:.5,color:[53,123,162,255]},{value:.625,color:[53,158,170,255]},{value:.75,color:[73,193,173,255]},{value:.875,color:[150,221,181,255]},{value:1,color:[222,245,229,255]}]})},mt=[["#1D5B79","#468B97","#EF6262","#F3AA60"],["#614BC3","#33BBC5","#85E6C5","#C8FFE0"],["#461959","#7A316F","#CD6688","#AED8CC"],["#0079FF","#00DFA2","#F6FA70","#FF0060"],["#39B5E0","#A31ACB","#FF78F0","#F5EA5A"],["#37E2D5","#590696","#C70A80","#FBCB0A"],["#FFD36E","#FFF56D","#99FFCD","#9FB4FF"],["#00EAD3","#FFF5B7","#FF449F","#005F99"],["#10A19D","#540375","#FF7000","#FFBF00"]];function Fe(){return mt[~~(Math.random()*mt.length)][~~(Math.random()*4)]}function Se(){return`maptiler_source_${Ct()}`}function we(){return`maptiler_layer_${Ct()}`}function dt(t,e){if(e<=t[0].zoom)return t[0].value;if(e>=t[t.length-1].zoom)return t[t.length-1].value;for(let r=0;r<t.length-1;r+=1)if(e>=t[r].zoom&&e<t[r+1].zoom){const a=t[r+1].zoom-t[r].zoom,o=(e-t[r].zoom)/a;return o*t[r+1].value+(1-o)*t[r].value}return 0}function se(t){return["interpolate",["linear"],["zoom"],...t.map(e=>[e.zoom,e.value]).flat()]}function P(t){return["interpolate",["linear"],["zoom"],...t.map(e=>[e.zoom,e.value]).flat()]}function sa(t,e){if(typeof e=="number"&&typeof t=="number")return 2*e+t;if(typeof e=="number"&&Array.isArray(t))return["interpolate",["linear"],["zoom"],...t.map(r=>[r.zoom,2*e+r.value]).flat()];if(typeof t=="number"&&Array.isArray(e))return["interpolate",["linear"],["zoom"],...e.map(r=>[r.zoom,2*r.value+t]).flat()];if(Array.isArray(t)&&Array.isArray(e)){const r=Array.from(new Set([...t.map(a=>a.zoom),...e.map(a=>a.zoom)])).sort((a,o)=>a<o?-1:1);return["interpolate",["linear"],["zoom"],...r.map(a=>[a,2*dt(e,a)+dt(t,a)]).flat()]}return 0}function ca(t,e){return["interpolate",["linear"],["get",e],...t.map(r=>[r.propertyValue,r.value]).flat()]}function $t(t){const e=t.trimStart(),r=`${e}${" ".repeat(t.length-e.length)}`,a=Array.from(r);if(!a.every(l=>l===" "||l==="_"))throw new Error("A dash pattern must be composed only of whitespace and underscore characters.");if(!(a.some(l=>l==="_")&&a.some(l=>l===" ")))throw new Error("A dash pattern must contain at least one underscore and one whitespace character");const i=[1];for(let l=1;l<a.length;l+=1){const s=a[l-1],h=a[l];s===h?i[i.length-1]+=1:i.push(1)}return i}function ft(t,e){return["interpolate",["linear"],["get",e],...t.map(r=>[r.value,r.color]).flat()]}function gt(t,e,r=!0){return r?["interpolate",["linear"],["zoom"],0,["interpolate",["linear"],["get",e],...t.map(a=>[a.value,a.pointRadius*.025]).flat()],2,["interpolate",["linear"],["get",e],...t.map(a=>[a.value,a.pointRadius*.05]).flat()],4,["interpolate",["linear"],["get",e],...t.map(a=>[a.value,a.pointRadius*.1]).flat()],8,["interpolate",["linear"],["get",e],...t.map(a=>[a.value,a.pointRadius*.25]).flat()],16,["interpolate",["linear"],["get",e],...t.map(a=>[a.value,a.pointRadius]).flat()]]:["interpolate",["linear"],["get",e],...t.map(a=>[a.value,a.pointRadius]).flat()]}function ua(t,e,r=!0){return r?["interpolate",["linear"],["zoom"],0,["interpolate",["linear"],["get",e],...t.map(a=>[a.propertyValue,a.value*.025]).flat()],2,["interpolate",["linear"],["get",e],...t.map(a=>[a.propertyValue,a.value*.05]).flat()],4,["interpolate",["linear"],["get",e],...t.map(a=>[a.propertyValue,a.value*.1]).flat()],8,["interpolate",["linear"],["get",e],...t.map(a=>[a.propertyValue,a.value*.25]).flat()],16,["interpolate",["linear"],["get",e],...t.map(a=>[a.propertyValue,a.value]).flat()]]:["interpolate",["linear"],["get",e],...t.map(a=>[a.propertyValue,a.value]).flat()]}function yt(t,e){return t.every(r=>r.color[3]===t[0].color[3])?t[0].color[3]?t[0].color[3]/255:1:["interpolate",["linear"],["get",e],...t.getRawColorStops().map(r=>{const a=r.value,o=r.color;return[a,o.length===4?o[3]/255:1]}).flat()]}function pa(t,e=10){return["interpolate",["linear"],["heatmap-density"],...Array.from({length:e+1},(r,a)=>{const o=a/e;return[o,t.getColorHex(o)]}).flat()]}var ha=Object.defineProperty,ma=Object.defineProperties,da=Object.getOwnPropertyDescriptors,vt=Object.getOwnPropertySymbols,fa=Object.prototype.hasOwnProperty,ga=Object.prototype.propertyIsEnumerable,_t=(t,e,r)=>e in t?ha(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ce=(t,e)=>{for(var r in e||(e={}))fa.call(e,r)&&_t(t,r,e[r]);if(vt)for(var r of vt(e))ga.call(e,r)&&_t(t,r,e[r]);return t},ya=(t,e)=>ma(t,da(e)),va=(t,e,r)=>new Promise((a,o)=>{var n=s=>{try{l(r.next(s))}catch(h){o(h)}},i=s=>{try{l(r.throw(s))}catch(h){o(h)}},l=s=>s.done?a(s.value):Promise.resolve(s.value).then(n,i);l((r=r.apply(t,e)).next())});function _a(t,e){return va(this,arguments,function*(r,a,o={}){var n,i,l;if(!a.sourceId&&!a.data)throw new Error("Creating a polyline layer requires an existing .sourceId or a valid .data property");let s=a.data;if(typeof s=="string"){if(Ae(s))s=`https://api.maptiler.com/data/${a.data}/features.json?key=${Z.apiKey}`;else if(((n=s.split(".").pop())==null?void 0:n.toLowerCase().trim())==="gpx"){const p=yield(yield fetch(s,o)).text();s=Ut(p)}else if(((i=s.split(".").pop())==null?void 0:i.toLowerCase().trim())==="kml"){const p=yield(yield fetch(s,o)).text();s=xt(p)}else{const h=(l=hr(s))!=null?l:oa(s);h&&(s=h)}if(!s)throw new Error("Polyline data was provided as string but is incompatible with valid formats.")}return La(r,ya(ce({},a),{data:s}))})}function La(t,e){var r,a,o,n,i,l,s,h,p,c,u,m,N,f,F,D,C,k,B,U;if(e.layerId&&t.getLayer(e.layerId))throw new Error(`A layer already exists with the layer id: ${e.layerId}`);const E=(r=e.sourceId)!=null?r:Se(),I=(a=e.layerId)!=null?a:we(),L={polylineLayerId:I,polylineOutlineLayerId:"",polylineSourceId:E};e.data&&!t.getSource(E)&&t.addSource(E,{type:"geojson",data:e.data});const T=(o=e.lineWidth)!=null?o:3,R=(n=e.lineColor)!=null?n:Fe(),M=(i=e.lineOpacity)!=null?i:1,_=(l=e.lineBlur)!=null?l:0,w=(s=e.lineGapWidth)!=null?s:0;let O=(h=e.lineDashArray)!=null?h:null;const x=(p=e.outlineWidth)!=null?p:1,z=(c=e.outlineColor)!=null?c:"#FFFFFF",H=(u=e.outlineOpacity)!=null?u:1,V=(m=e.outlineBlur)!=null?m:0;if(typeof O=="string"&&(O=$t(O)),e.outline===!0){const X=`${I}_outline`;L.polylineOutlineLayerId=X,t.addLayer({id:X,type:"line",source:E,layout:{"line-join":(N=e.lineJoin)!=null?N:"round","line-cap":(f=e.lineCap)!=null?f:"round"},minzoom:(F=e.minzoom)!=null?F:0,maxzoom:(D=e.maxzoom)!=null?D:23,paint:{"line-opacity":typeof H=="number"?H:P(H),"line-color":typeof z=="string"?z:se(z),"line-width":sa(T,x),"line-blur":typeof V=="number"?V:P(V)}},e.beforeId)}return t.addLayer({id:I,type:"line",source:E,layout:{"line-join":(C=e.lineJoin)!=null?C:"round","line-cap":(k=e.lineCap)!=null?k:"round"},minzoom:(B=e.minzoom)!=null?B:0,maxzoom:(U=e.maxzoom)!=null?U:23,paint:ce({"line-opacity":typeof M=="number"?M:P(M),"line-color":typeof R=="string"?R:se(R),"line-width":typeof T=="number"?T:P(T),"line-blur":typeof _=="number"?_:P(_),"line-gap-width":typeof w=="number"?w:P(w)},O&&{"line-dasharray":O})},e.beforeId),L}function Aa(t,e){var r,a,o,n,i,l,s,h,p,c,u;if(e.layerId&&t.getLayer(e.layerId))throw new Error(`A layer already exists with the layer id: ${e.layerId}`);const m=(r=e.sourceId)!=null?r:Se(),N=(a=e.layerId)!=null?a:we(),f={polygonLayerId:N,polygonOutlineLayerId:e.outline?`${N}_outline`:"",polygonSourceId:m};if(e.data&&!t.getSource(m)){let R=e.data;typeof R=="string"&&Ae(R)&&(R=`https://api.maptiler.com/data/${R}/features.json?key=${Z.apiKey}`),t.addSource(m,{type:"geojson",data:R})}let F=(o=e.outlineDashArray)!=null?o:null;const D=(n=e.outlineWidth)!=null?n:1,C=(i=e.outlineColor)!=null?i:"#FFFFFF",k=(l=e.outlineOpacity)!=null?l:1,B=(s=e.outlineBlur)!=null?s:0,U=(h=e.fillColor)!=null?h:Fe(),E=(p=e.fillOpacity)!=null?p:1,I=(c=e.outlinePosition)!=null?c:"center",L=(u=e.pattern)!=null?u:null;typeof F=="string"&&(F=$t(F));const T=(R=null)=>{var M,_,w,O,x,z;if(t.addLayer({id:N,type:"fill",source:m,minzoom:(M=e.minzoom)!=null?M:0,maxzoom:(_=e.maxzoom)!=null?_:23,paint:ce({"fill-color":typeof U=="string"?U:se(U),"fill-opacity":typeof E=="number"?E:P(E)},R&&{"fill-pattern":R})},e.beforeId),e.outline===!0){let H;I==="inside"?typeof D=="number"?H=.5*D:H=P(D.map(({zoom:V,value:X})=>({zoom:V,value:.5*X}))):I==="outside"?typeof D=="number"?H=-.5*D:H=P(D.map(V=>({zoom:V.zoom,value:-.5*V.value}))):H=0,t.addLayer({id:f.polygonOutlineLayerId,type:"line",source:m,layout:{"line-join":(w=e.outlineJoin)!=null?w:"round","line-cap":(O=e.outlineCap)!=null?O:"butt"},minzoom:(x=e.minzoom)!=null?x:0,maxzoom:(z=e.maxzoom)!=null?z:23,paint:ce({"line-opacity":typeof k=="number"?k:P(k),"line-color":typeof C=="string"?C:se(C),"line-width":typeof D=="number"?D:P(D),"line-blur":typeof B=="number"?B:P(B),"line-offset":H},F&&{"line-dasharray":F})},e.beforeId)}};return L?t.hasImage(L)?T(L):t.loadImage(L,(R,M)=>{if(R)return console.error("Could not load the pattern image.",R.message),T();if(!M)return console.error(`An image cannot be created from the pattern URL ${L}.`),T();t.addImage(L,M),T(L)}):T(),f}function Sa(t,e){var r,a,o,n,i,l,s,h,p,c,u,m,N,f,F,D;if(e.layerId&&t.getLayer(e.layerId))throw new Error(`A layer already exists with the layer id: ${e.layerId}`);const C=(r=e.minPointRadius)!=null?r:10,k=(a=e.maxPointRadius)!=null?a:50,B=(o=e.cluster)!=null?o:!1,U=20,E=Array.isArray(e.pointColor)?e.pointColor:kt.TURBO.scale(10,e.cluster?1e4:1e3).resample("ease-out-square"),I=E.getBounds(),L=(n=e.sourceId)!=null?n:Se(),T=(i=e.layerId)!=null?i:we(),R=(l=e.showLabel)!=null?l:B,M=(s=e.alignOnViewport)!=null?s:!0,_=(h=e.outline)!=null?h:!1,w=(p=e.outlineOpacity)!=null?p:1,O=(c=e.outlineWidth)!=null?c:1,x=(u=e.outlineColor)!=null?u:"#FFFFFF";let z;const H=(m=e.zoomCompensation)!=null?m:!0,V=(N=e.minzoom)!=null?N:0,X=(f=e.maxzoom)!=null?f:23;typeof e.pointOpacity=="number"?z=e.pointOpacity:Array.isArray(e.pointOpacity)?z=P(e.pointOpacity):e.cluster?z=yt(E,"point_count"):e.property?z=yt(E,e.property):z=P([{zoom:V,value:0},{zoom:V+.25,value:1},{zoom:X-.25,value:1},{zoom:X,value:0}]);const oe={pointLayerId:T,clusterLayerId:"",labelLayerId:"",pointSourceId:L};if(e.data&&!t.getSource(L)){let G=e.data;typeof G=="string"&&Ae(G)&&(G=`https://api.maptiler.com/data/${G}/features.json?key=${Z.apiKey}`),t.addSource(L,{type:"geojson",data:G,cluster:B})}if(B){oe.clusterLayerId=`${T}_cluster`;const G=Array.from({length:U},(de,fe)=>{const Te=I.min+fe*(I.max-I.min)/(U-1);return{value:Te,pointRadius:C+(k-C)*Math.pow(fe/(U-1),.5),color:E.getColorHex(Te)}});t.addLayer({id:oe.clusterLayerId,type:"circle",source:L,filter:["has","point_count"],paint:ce({"circle-color":typeof e.pointColor=="string"?e.pointColor:ft(G,"point_count"),"circle-radius":typeof e.pointRadius=="number"?e.pointRadius:Array.isArray(e.pointRadius)?P(e.pointRadius):gt(G,"point_count",!1),"circle-pitch-alignment":M?"viewport":"map","circle-pitch-scale":"map","circle-opacity":z},_&&{"circle-stroke-opacity":typeof w=="number"?w:P(w),"circle-stroke-width":typeof O=="number"?O:P(O),"circle-stroke-color":typeof x=="string"?x:se(x)}),minzoom:V,maxzoom:X},e.beforeId),t.addLayer({id:oe.pointLayerId,type:"circle",source:L,filter:["!",["has","point_count"]],paint:ce({"circle-pitch-alignment":M?"viewport":"map","circle-pitch-scale":"map","circle-color":typeof e.pointColor=="string"?e.pointColor:E.getColorHex(E.getBounds().min),"circle-radius":typeof e.pointRadius=="number"?e.pointRadius:Array.isArray(e.pointRadius)?P(e.pointRadius):G[0].pointRadius*.75,"circle-opacity":z},_&&{"circle-stroke-opacity":typeof w=="number"?w:P(w),"circle-stroke-width":typeof O=="number"?O:P(O),"circle-stroke-color":typeof x=="string"?x:se(x)}),minzoom:V,maxzoom:X},e.beforeId)}else{let G=typeof e.pointColor=="string"?e.pointColor:Array.isArray(e.pointColor)?e.pointColor.getColorHex(e.pointColor.getBounds().min):Fe(),de=typeof e.pointRadius=="number"?H?P([{zoom:0,value:e.pointRadius*.025},{zoom:2,value:e.pointRadius*.05},{zoom:4,value:e.pointRadius*.1},{zoom:8,value:e.pointRadius*.25},{zoom:16,value:e.pointRadius*1}]):e.pointRadius:Array.isArray(e.pointRadius)?P(e.pointRadius):H?P([{zoom:0,value:C*.05},{zoom:2,value:C*.1},{zoom:4,value:C*.2},{zoom:8,value:C*.5},{zoom:16,value:C*1}]):C;if(e.property&&Array.isArray(e.pointColor)){const fe=Array.from({length:U},(Te,Be)=>{const ke=I.min+Be*(I.max-I.min)/(U-1);return{value:ke,pointRadius:typeof e.pointRadius=="number"?e.pointRadius:C+(k-C)*Math.pow(Be/(U-1),.5),color:typeof e.pointColor=="string"?e.pointColor:E.getColorHex(ke)}});G=ft(fe,e.property),de=gt(fe,e.property,H)}t.addLayer({id:oe.pointLayerId,type:"circle",source:L,layout:{"circle-sort-key":e.property?["/",1,["get",e.property]]:0},paint:ce({"circle-pitch-alignment":M?"viewport":"map","circle-pitch-scale":"map","circle-color":G,"circle-opacity":z,"circle-radius":de},_&&{"circle-stroke-opacity":typeof w=="number"?w:P(w),"circle-stroke-width":typeof O=="number"?O:P(O),"circle-stroke-color":typeof x=="string"?x:se(x)}),minzoom:V,maxzoom:X},e.beforeId)}if(R!==!1&&(e.cluster||e.property)){oe.labelLayerId=`${T}_label`;const G=(F=e.labelColor)!=null?F:"#fff",de=(D=e.labelSize)!=null?D:12;t.addLayer({id:oe.labelLayerId,type:"symbol",source:L,filter:["has",e.cluster?"point_count":e.property],layout:{"text-field":e.cluster?"{point_count_abbreviated}":`{${e.property}}`,"text-font":["Noto Sans Regular"],"text-size":de,"text-pitch-alignment":M?"viewport":"map","symbol-sort-key":["/",1,["get",e.cluster?"point_count":e.property]]},paint:{"text-color":G,"text-opacity":z},minzoom:V,maxzoom:X},e.beforeId)}return oe}function wa(t,e){var r,a,o,n,i,l,s,h,p,c;if(e.layerId&&t.getLayer(e.layerId))throw new Error(`A layer already exists with the layer id: ${e.layerId}`);const u=(r=e.sourceId)!=null?r:Se(),m=(a=e.layerId)!=null?a:we(),N=(o=e.minzoom)!=null?o:0,f=(n=e.maxzoom)!=null?n:23,F=(i=e.zoomCompensation)!=null?i:!0,D=(l=e.opacity)!=null?l:[{zoom:N,value:0},{zoom:N+.25,value:1},{zoom:f-.25,value:1},{zoom:f,value:0}];let C=Array.isArray(e.colorRamp)?e.colorRamp:kt.TURBO.transparentStart();const k=C.getBounds();(k.min!==0||k.max!==1)&&(C=C.scale(0,1)),C.hasTransparentStart()||(C=C.transparentStart());const B=(s=e.intensity)!=null?s:[{zoom:0,value:.01},{zoom:4,value:.2},{zoom:16,value:1}],U=(h=e.property)!=null?h:null,E=(p=e.weight)!=null?p:1;let I=1;U?typeof E=="number"?(I=E,typeof e.weight=="number"&&console.warn("The option `.property` is ignored when `.propertyValueWeights` is not of type `PropertyValueWeights`")):Array.isArray(E)?I=ca(E,U):console.warn("The option `.property` is ignored when `.propertyValueWeights` is not of type `PropertyValueWeights`"):typeof E=="number"?I=E:Array.isArray(E)&&console.warn("The options `.propertyValueWeights` can only be used when `.property` is provided.");const L=[{zoom:0,value:50*.025},{zoom:2,value:50*.05},{zoom:4,value:50*.1},{zoom:8,value:50*.25},{zoom:16,value:50}],T=(c=e.radius)!=null?c:F?L:10;let R=1;typeof T=="number"?R=T:Array.isArray(T)&&"zoom"in T[0]?R=P(T):U&&Array.isArray(T)&&"propertyValue"in T[0]?R=ua(T,U,F):!U&&Array.isArray(T)&&"propertyValue"in T[0]?(R=P(L),console.warn("The option `.radius` can only be property-driven if the option `.property` is provided.")):R=P(L);const M={heatmapLayerId:m,heatmapSourceId:u};if(e.data&&!t.getSource(u)){let _=e.data;typeof _=="string"&&Ae(_)&&(_=`https://api.maptiler.com/data/${_}/features.json?key=${Z.apiKey}`),t.addSource(u,{type:"geojson",data:_})}return t.addLayer({id:m,type:"heatmap",source:u,minzoom:N,maxzoom:f,paint:{"heatmap-weight":I,"heatmap-intensity":typeof B=="number"?B:P(B),"heatmap-color":pa(C),"heatmap-radius":R,"heatmap-opacity":typeof D=="number"?D:P(D)}}),M}const Lt={addPolyline:_a,addPolygon:Aa,addPoint:Sa,addHeatmap:wa},{setRTLTextPlugin:Va,getRTLTextPluginStatus:Ga,LngLat:Ta,LngLatBounds:ja,MercatorCoordinate:Ka,Evented:Wa,AJAXError:Za,prewarm:Ya,clearPrewarmedResources:qa,version:Ja,workerCount:Xa,maxParallelImageRequests:Qa,workerUrl:eo,addProtocol:to,removeProtocol:ro}=y;y.Map;y.Marker;y.Popup;y.Style;y.CanvasSource;y.GeoJSONSource;y.ImageSource;y.RasterTileSource;y.RasterDEMTileSource;y.VectorTileSource;y.VideoSource;y.NavigationControl;y.GeolocateControl;y.AttributionControl;y.LogoControl;y.ScaleControl;y.FullscreenControl;y.TerrainControl;let Ra=null;function Ia(){v.MaptilerLayer=v.Layer.extend({options:{updateInterval:32,padding:.1,interactive:!1,pane:"tilePane"},map:null,initialize:function(t){v.setOptions(this,t),this._throttledUpdate=v.Util.throttle(this._update,this.options.updateInterval,this)},onAdd:function(t){this._container||this._initContainer();const e=document.createElement("a");e.href="https://www.maptiler.com",e.style="position:absolute; left:10px; bottom:2px; z-index:999;";const r=document.createElement("img");r.src="https://api.maptiler.com/resources/logo.svg",r.alt="MapTiler logo",r.width="100",r.height="30",e.appendChild(r),t.getContainer().appendChild(e);const a=this.getPaneName();t.getPane(a).appendChild(this._container),this._initMaptilerSDK(),this._offset=this._map.containerPointToLayerPoint([0,0]),t.options.zoomAnimation&&v.DomEvent.on(t._proxy,v.DomUtil.TRANSITION_END,this._transitionEnd,this),t.attributionControl.addAttribution('<a href="https://www.maptiler.com/copyright/" target="_blank">&copy; MapTiler</a> <a href="https://www.openstreetmap.org/copyright" target="_blank">&copy; OpenStreetMap contributors</a>')},onRemove:function(t){this._map._proxy&&this._map.options.zoomAnimation&&v.DomEvent.off(this._map._proxy,v.DomUtil.TRANSITION_END,this._transitionEnd,this);const e=this.getPaneName();t.getPane(e).removeChild(this._container),this._maptilerMap.remove(),this._maptilerMap=null},getEvents:function(){return{move:this._throttledUpdate,zoomanim:this._animateZoom,zoom:this._pinchZoom,zoomstart:this._zoomStart,zoomend:this._zoomEnd,resize:this._resize}},getMaptilerSDKMap:function(){return this._maptilerMap},getCanvas:function(){return this._maptilerMap.getCanvas()},getSize:function(){return this._map.getSize().multiplyBy(1+this.options.padding*2)},getBounds:function(){const t=this.getSize().multiplyBy(.5),e=this._map.latLngToContainerPoint(this._map.getCenter());return v.latLngBounds(this._map.containerPointToLatLng(e.subtract(t)),this._map.containerPointToLatLng(e.add(t)))},getContainer:function(){return this._container},getPaneName:function(){return this._map.getPane(this.options.pane)?this.options.pane:"tilePane"},setStyle:function(t){this._maptilerMap.setStyle(t)},setLanguage:function(t){this._maptilerMap.setLanguage(t)},_roundPoint:function(t){return{x:Math.round(t.x),y:Math.round(t.y)}},_initContainer:function(){const t=this._container=v.DomUtil.create("div","leaflet-gl-layer"),e=this.getSize(),r=this._map.getSize().multiplyBy(this.options.padding);t.style.width=e.x+"px",t.style.height=e.y+"px";const a=this._map.containerPointToLayerPoint([0,0]).subtract(r);v.DomUtil.setPosition(t,this._roundPoint(a))},_initMaptilerSDK:function(){const t=this._map.getCenter();let e=this.options.style,r=this.options.apiKey;if((typeof this.options.style=="string"||this.options.style instanceof String)&&this.options.style.startsWith("https://api.maptiler.com/maps/"))try{const n=new URL(this.options.style),i=n.searchParams.get("key");i&&(r=i,n.searchParams.delete("key"),e=n.href)}catch(n){console.error(n)}const a={...this.options,style:e,apiKey:r,container:this._container,center:[t.lng,t.lat],zoom:this._map.getZoom()-1,attributionControl:!1};this.options.geolocate&&(delete a.center,delete a.zoom),this._maptilerMap=new Ot(a),this._maptilerMap.once("load",()=>{this.fire("ready")}),this._maptilerMap.transform.freezeElevation=!0,this.options.geolocate&&this._maptilerMap.on("load",()=>{this._map.setView(this._maptilerMap.getCenter(),this._maptilerMap.getZoom()+1)}),this._maptilerMap.transform.latRange=null,this._maptilerMap.transform.maxValidLatitude=1/0,this._transformGL(),this._maptilerMap._actualCanvas=this._maptilerMap._canvas;const o=this._maptilerMap._actualCanvas;v.DomUtil.addClass(o,"leaflet-image-layer"),v.DomUtil.addClass(o,"leaflet-zoom-animated"),this.options.interactive&&v.DomUtil.addClass(o,"leaflet-interactive"),this.options.className&&v.DomUtil.addClass(o,this.options.className),Object.keys(Lt).forEach(n=>{this[n]=i=>Lt[n].apply(null,[this._maptilerMap,i])})},_update:function(){if(this._offset=this._map.containerPointToLayerPoint([0,0]),this._zooming)return;const t=this.getSize(),e=this._map.getSize().multiplyBy(this.options.padding),r=this._map.containerPointToLayerPoint([0,0]).subtract(e);v.DomUtil.setPosition(this._container,this._roundPoint(r)),this._transformGL(),this._maptilerMap.transform.width!==t.x||this._maptilerMap.transform.height!==t.y?(this._container.style.width=t.x+"px",this._container.style.height=t.y+"px",this._maptilerMap._resize!==null&&this._maptilerMap._resize!==void 0?this._maptilerMap._resize():this._maptilerMap.resize()):this._maptilerMap._update!==null&&this._maptilerMap._update!==void 0?this._maptilerMap._update():this._maptilerMap.update()},_transformGL:function(){const t=this._map.getCenter(),e=this._maptilerMap.transform;e.center=Ta.convert([t.lng,t.lat]),e.zoom=this._map.getZoom()-1},_pinchZoom:function(){this._maptilerMap.jumpTo({zoom:this._map.getZoom()-1,center:this._map.getCenter()})},_animateZoom:function(t){const e=this._map.getZoomScale(t.zoom),r=this._map.getSize().multiplyBy(this.options.padding*e),a=this.getSize()._divideBy(2),o=this._map.project(t.center,t.zoom)._subtract(a)._add(this._map._getMapPanePos().add(r))._round(),n=this._map.project(this._map.getBounds().getNorthWest(),t.zoom)._subtract(o);v.DomUtil.setTransform(this._maptilerMap._actualCanvas,n.subtract(this._offset),e)},_zoomStart:function(){this._zooming=!0},_zoomEnd:function(){const t=this._map.getZoomScale(this._map.getZoom());v.DomUtil.setTransform(this._maptilerMap._actualCanvas,null,t),this._zooming=!1,this._update()},_transitionEnd:function(){v.Util.requestAnimFrame(function(){const t=this._map.getZoom(),e=this._map.getCenter(),r=this._map.latLngToContainerPoint(this._map.getBounds().getNorthWest());v.DomUtil.setTransform(this._maptilerMap._actualCanvas,r,1),this._maptilerMap.once("moveend",v.Util.bind(function(){this._zoomEnd()},this)),this._maptilerMap.jumpTo({center:e,zoom:t-1})},this)},_resize:function(t){this._transitionEnd(t)}}),Ra=v.MaptilerLayer,v.maptilerLayer=function(t){return new v.MaptilerLayer(t)},v.maptilerLayer,v.MaptilerStyle={},Object.keys(Ee).forEach(t=>{v.MaptilerStyle[t]=Ee[t]}),v.MaptilerStyle,v.MaptilerStyle,v.maptilerStyle=v.MaptilerStyle,v.MaptilerLanguage={},Object.keys(A).forEach(t=>{v.MaptilerLanguage[t]=A[t]}),v.MaptilerLanguage,v.MaptilerLanguage,v.maptilerLanguage=v.MaptilerLanguage}(()=>{try{Ia()}catch(t){console.error(t)}})();export{Ra as l};
